<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Reporte de Supervisión</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
<style>


    /* Evita el desplazamiento horizontal y asegura que el body ocupe el 100% del viewport */
    body, html {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f9f9f9;
        color: #333;
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
        width: 100%;
        max-width: 100%;
        overflow-x: hidden; /* Oculta el desplazamiento horizontal */
    }

    /* Header */
    .header {
        background-color: #007BFF;
        color: white;
        text-align: center;
        padding: 15px;
        width: 100%;
        font-size: 1.5em;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        box-sizing: border-box; /* Asegura que el padding no exceda el ancho */
    }

    /* Contenedor del formulario */
    .container {
        background: #ffffff;
        padding: 20px;
        border-radius: 10px;
        width: 90%;
        max-width: 600px;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
        margin-top: 20px;
        text-align: center;
        margin: 40px auto;
        grid-row: 2;
        height: auto;
        box-sizing: border-box; /* Incluye el padding en el ancho total */
    }

    h1 {
        text-align: center;
        color: #333;
        margin: 0 0 20px 0; /* Ajusta el margen inferior */
    }

    label {
        display: block;
        margin-top: 10px;
        font-weight: bold;
    }

    input[type="date"],
    input[type="time"],
    textarea,
    select,
    #oficina,
    button {
        width: 100%;
        margin-top: 5px;
        padding: 10px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-sizing: border-box; /* Incluye el padding en el ancho total */
    }

    button {
        background-color: #007bff;
        color: #fff;
        border: none;
        cursor: pointer;
        padding: 12px 0;
    }

    button:hover {
        background-color: #0056b3;
    }

    /* Estilo para el botón "Volver al Inicio" */
    .back-button {
        display: inline-block;
        padding: 10px 20px;
        background-color: #007BFF;
        color: white;
        border-radius: 5px;
        text-decoration: none;
        text-align: center;
        font-size: 1em;
        transition: background-color 0.3s, transform 0.3s;
        position: fixed;
        top: 80px;
        left: 0px;
        z-index: 1001;
        box-sizing: border-box; /* Incluye el padding en el ancho total */
    }

    .back-button:hover {
        background-color: #0056b3;
        transform: scale(1.05);
    }

    /* Estilo para los contenedores de preguntas */
    .question-container {
        margin-bottom: 20px;
        text-align: left;
        padding: 10px;
        border: 2px solid #ccc;
        border-radius: 5px;
        background-color: #f9f9f9;
        transition: border-color 0.3s;
        box-sizing: border-box; /* Incluye el padding en el ancho total */
    }

    .question-container:hover {
        border-color: #007BFF;
    }

    .question-container input[type="date"],
    .question-container input[type="time"],
    .question-container textarea,
    .question-container oficina,
    .question-container select {
        padding: 10px;
        border: 2px solid #ccc;
        border-radius: 5px;
        width: 100%;
        font-size: 16px;
        background-color: #f9f9f9;
        color: #333;
        transition: border-color 0.3s;
        box-sizing: border-box; /* Incluye el padding en el ancho total */
        margin-top: 5px;
    }

    .question-container input[type="date"]:focus,
    .question-container input[type="time"]:focus,
    .question-container textarea:focus,
    .question-container oficina:focus,
    .question-container select:focus {
        border-color: #007BFF;
        outline: none;
    }


    /* Estilo del overlay (pantalla bloqueada */


    #overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
    }

    #loadingMessage {
        color: white;
        font-size: 24px;
        font-family: 'Times New Roman', Times, serif;
        text-align: center;
        padding: 20px;
    }


    /* Estilo del overlay (pantalla bloqueada */


    /* Estilo para Mensajes */


    .swal-actions {
        display: flex; /* Coloca los botones en una fila */
        justify-content: center; /* Centra los botones horizontalmente */
        gap: 10px; /* Espacio entre los botones */
    }


    /* Estilo personalizado para el contenido del mensaje */
    .swal-content {
        font-size: 0.9em;  /* Reduce el tamaño del texto */
        line-height: 1.4;  /* Ajusta el espaciado entre líneas */
    }

    /* Estilo personalizado para ambos botones */
    .swal-button, .swal-button-cancel {
        font-size: 0.9em;  /* Ajusta el tamaño del texto del botón */
        padding: 10px 20px;  /* Espaciado interno */
        min-width: 100px;  /* Ancho mínimo para igualar botones */
        text-align: center;  /* Centra el texto dentro del botón */
    }

    /* Estilo personalizado para el popup/modal */
    .swal-popup {
        width: 300px;  /* Ajusta el ancho máximo del modal */
        max-width: 90%;  /* Permite que el modal sea flexible en pantallas pequeñas */
    }

    /* Opcional: colores específicos para cada botón */
    .swal-button {
        background-color: #28a745;  /* Verde para el botón de "Sí" */
        color: white;  /* Texto en blanco */
        border: none;
        border-radius: 4px;
    }

    .swal-button-cancel {
        background-color: #FF6347 ;  /* Rojo para el botón de "No" */
        color: white;  /* Texto oscuro */
        border: none;
        border-radius: 4px;
    }

    .swal2-actions {
        display: flex !important;  /* Asegura que los botones estén en una fila */
        justify-content: center;   /* Centra los botones horizontalmente */
        gap: 10px;                 /* Agrega espacio entre los botones */
        flex-wrap: nowrap;         /* Evita que los botones se apilen en dos filas */
    }


    /* Estilo para Mensajes */


    /* Estilo para Datos Adjuntos */


    .image-preview {
        width: 100%;
        max-height: 200px;
        overflow-y: auto;
        border: 0px solid #ccc;
        padding: 10px;
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        box-sizing: border-box;
    }

    .image-preview-item {
        position: relative;
        width: 85px;
        height: 85px;
        overflow: hidden;
        border-radius: 5px;
        border: 1px solid #ddd;
    }

    .image-preview-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .delete-icon {
        position: absolute;
        top: 5px;
        left: 5px;
        width: 20px;
        height: 20px;
        background: rgba(255, 0, 0, 0.8);
        color: #fff;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        cursor: pointer;
        opacity: 0;
        transition: opacity 0.3s;
    }

    .image-preview-item:hover .delete-icon {
        opacity: 1;
    }

    /* Estilos para el área de carga de imágenes */
    .file-upload {
        display: block;
        position: relative;
        width: 100%;
        padding: 20px;
        background: #f0f8ff;
        border: 2px dashed #ccc;
        text-align: center;
        border-radius: 5px;
        font-size: 16px;
        cursor: pointer;
        margin-top: 10px;
        box-sizing: border-box;
        border: 2px dashed #007BFF;
        border-radius: 10px;
        padding: 40px 20px;
        text-align: center;
        cursor: pointer;
        font-size: 16px;
        background-color: #f0f8ff;
        color: #007BFF;
        transition: background-color 0.3s ease, border-color 0.3s ease;
        margin: 10px 0;
    }

    .file-upload:hover {
        border-color: #0056b3;
    }

    .file-upload input[type="file"] {
        display: none;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        cursor: pointer;
    }


    /* Estilo para Datos Adjuntos */


    /* Estilo para Mostrar/Ocultar Paginación */


    /* Clase para ocultar las páginas */
        .hidden {
        display: none;
    }

    /* Clase para mostrar la página actual */
        .visible {
        display: block;
    }


    /* Estilo para Mostrar/Ocultar Paginación */


    /* Estilo para Botones, Habilitar/Deshabilitar*/


    #enviarBtn,
    #next {
        background-color: #007bff; /* Color azul */
        color: white;
        border: none;
        cursor: pointer;
        padding: 12px 0;
        font-size: 16px;
        border-radius: 5px;
        transition: background-color 0.3s ease, opacity 0.3s ease;
    }

    /* Estilo para el botón de enviar cuando está deshabilitado */
    #enviarBtn:disabled,
    #next:disabled {
        background-color: #ccc; /* Color gris */
        color: #666666; /* Texto gris oscuro */
        cursor: not-allowed; /* Cambia el cursor a "no permitido" */
        opacity: 0.7; /* Reduce la opacidad para dar un aspecto deshabilitado */
    }

    /* Efecto hover solo cuando el botón está habilitado */
        #enviarBtn:not(:disabled):hover,
        #next:not(:disabled):hover {
        background-color: #0056b3; /* Color azul más oscuro al pasar el mouse */
    }


    /* Estilo para Botones, Habilitar/Deshabilitar*/


    /* Estilo para Botones, Misma Linea*/


    /* Contenedor flexible para los botones */
    .botones-container {
        display: flex; /* Hace que los botones estén en la misma línea */
        justify-content: space-between; /* Espacio entre los botones */
        gap: 10px; /* Espacio entre los botones */
        margin-top: 20px; /* Margen superior para separar del contenido anterior */
    }

    /* Estilo para los botones dentro del contenedor */
    .botones-container button {
        flex: 1; /* Hace que los botones ocupen el espacio disponible */
        margin: 0; /* Elimina el margen predeterminado */
    }


    /* Estilo para Botones, Misma Linea*/


</style>


</head>


<body>
    <div class="header">
        Pisos Brillantes
    </div>
    <a href="javascript:void(0);" class="back-button" onclick="goBack()">Volver al Inicio</a>
    <div class="container">
        <h1>Reporte de Supervisión de Áreas</h1>
        <div class="form-container">

            <!-- Página 1: Ingreso de Fecha y Área -->
            <div id="page1">
                <div class="question-container">
                    <label for="fecha">Fecha:</label>
                    <input type="date" id="fecha" name="fecha" required>
                </div>

                <div class="question-container">
                    <label for="area">Área:</label>
                    <select id="area">
                        <option value="Selecciona una opción">Selecciona una opción</option>
                        <option value="Administración">Administración</option>
                        <option value="Almacén General">Almacén General</option>
                        <option value="Baños de Administración (Hombres)">Baños de Administración (Hombres)</option>
                        <option value="Baños de Administración (Mujeres)">Baños de Administración (Mujeres)</option>
                        <option value="Baños de Transportistas">Baños de Transportistas</option>
                        <option value="Bodega de Limpieza">Bodega de Limpieza</option>
                        <option value="Camerinos Contratistas">Camerinos Contratistas</option>
                        <option value="Camerinos Permanentes">Camerinos Permanentes</option>
                        <option value="Chiminike">Chiminike</option>
                        <option value="Club de Argos">Club de Argos</option>
                        <option value="Despacho">Despacho</option>
                        <option value="Enfermería">Enfermería</option>
                        <option value="Equipo Móvil">Equipo Móvil</option>
                        <option value="Expedición">Expedición</option>
                        <option value="Laboratorio de Calidad">Laboratorio de Calidad</option>
                        <option value="Laboratorio de Concreto">Laboratorio de Concreto</option>
                        <option value="Machaqueo A">Machaqueo A</option>
                        <option value="Posta Principal">Posta Principal</option>
                        <option value="Sala de Control">Sala de Control</option>
                        <option value="Sala de Maternidad">Sala de Maternidad</option>
                        <option value="Salón Vial">Salón Vial</option>
                        <option value="Taller Eléctrico">Taller Eléctrico</option>
                    </select>
                </div>
            </div>

            <!-- Página 2: Calificación de Oficinas -->
            <div id="page2" class="hidden">
                <div class="question-container">
                    <label for="calificarOficinas">¿Deseas calificar las Oficinas?</label>
                    <select id="calificarOficinas">
                        <option value="">Selecciona una opción</option>
                        <option value="Sí">Sí</option>
                        <option value="No">No</option>
                    </select>
                </div>

                <div id="oficinaAdministracion" class="question-container" style="display: none;">
                    <label for="oficina">Oficina de Administración:</label>
                    <input type="text" id="oficina" placeholder="Especifica la oficina" />
                </div>

                <div id="questionsSectionOficinas" style="display: none;">
                    <!-- Preguntas generadas dinámicamente para oficinas -->
                </div>
            </div>


            <!-- Página 3: Calificación de Pasillos -->
            <div id="page3" class="hidden">
                <div class="question-container">
                    <label for="calificarPasillos">¿Deseas calificar los Pasillos?</label>
                    <select id="calificarPasillos">
                        <option value="">Selecciona una opción</option>
                        <option value="Sí">Sí</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div id="questionsSectionPasillos" style="display: none;">
                    <!-- Preguntas generadas dinámicamente para pasillos -->
                </div>
            </div>

            <!-- Página 4: Calificación de Food Court / Área de Comida -->
            <div id="page4" class="hidden">
                <div class="question-container">
                    <label for="calificarFood">¿Deseas calificar el Food Court / Área de Comida?</label>
                    <select id="calificarFood">
                        <option value="">Selecciona una opción</option>
                        <option value="Sí">Sí</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div id="questionsSectionFood" style="display: none;">
                    <!-- Preguntas generadas dinámicamente para Food Court / Área de Comida -->
                </div>
            </div>

            <!-- Página 5: Calificación de Baños -->
            <div id="page5" class="hidden">
                <div class="question-container">
                    <label for="calificarBano">¿Deseas calificar los Baños?</label>
                    <select id="calificarBano">
                        <option value="">Selecciona una opción</option>
                        <option value="Sí">Sí</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div id="questionsSectionBano" style="display: none;">
                    <!-- Preguntas generadas dinámicamente para Baños -->
                </div>
            </div>

            <!-- Página 6: Calificación de Alrededores -->
            <div id="page6" class="hidden">
                <div class="question-container">
                    <label for="calificarAlrededor">¿Deseas calificar los Alrededores?</label>
                    <select id="calificarAlrededor">
                        <option value="">Selecciona una opción</option>
                        <option value="Sí">Sí</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div id="questionsSectionAlrededor" style="display: none;">
                    <!-- Preguntas generadas dinámicamente para Alrededores -->
                </div>
            </div>

            <!-- Página 7: Calificación de Buenas Prácticas -->
            <div id="page7" class="hidden">
                <div class="question-container">
                    <label for="calificarPractica">¿Deseas calificar las Buenas Prácticas?</label>
                    <select id="calificarPractica">
                        <option value="">Selecciona una opción</option>
                        <option value="Sí">Sí</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div id="questionsSectionPractica" style="display: none;">
                    <!-- Preguntas generadas dinámicamente para las buenas prácticas -->
                </div>
            </div>

            <!-- Página 8: Comentarios -->
            <div id="page8" class="hidden">
                <div class="question-container">
                    <label for="comentarios">¿Qué medidas se tomaron en caso de una no conformidad?</label>
                    <textarea id="comentarios" rows="10" cols="50" placeholder="Escribe aquí tus comentarios..."></textarea>
                </div>
            </div>

            <!-- Página 9: Subir imágenes y Descargar PDF -->
            <div id="page9" class="hidden">
                <div class="question-container">
                    <label for="adjunto1">Evidencia:</label>
                    <div class="file-upload" id="drag-area1" onclick="document.getElementById('adjunto1').click()">
                        <input type="file" id="adjunto1" name="adjunto1" accept="image/*" multiple>
                        <span class="file-upload-text">Haz clic o arrastra imágenes para adjuntarlas</span>
                    </div>
                    <div id="preview1" class="image-preview"></div>
                </div>
            </div>

<div class="botones-container">
                <button type="button" id="back">Regresar</button>
                <button type="button" id="next">Siguiente</button>
                <button type="button" id="enviarBtn" disabled onclick="confirmarEnvio()">Enviar</button>
</div>

            <!-- Contenedor para bloquear la pantalla -->
            <div id="overlay" style="display: none;">
                <div id="loadingMessage">
                    <p>Procesando...🥱</p>
                </div>
            </div>

        </div>
    </div>


</body>


<script>


<!-- Contenedor de Volver-->


// Función para volver al inicio
function goBack() {
    window.history.back();
}


<!-- Contenedor de Volver-->


<!-- Contenedor de Carga-->

// Prellenar fecha y hora al cargar la página
window.onload = prellenarFechaHora;


<!-- Contenedor de Carga-->


<!-- Contenedor para Precargar Fecha-->

// Prellenar fecha y hora
function prellenarFechaHora() {
    let today = new Date();
    let year = today.getFullYear();
    let month = String(today.getMonth() + 1).padStart(2, "0");
    let day = String(today.getDate()).padStart(2, "0");
    document.getElementById("fecha").value = `${year}-${month}-${day}`;
}

<!-- Contenedor para Precargar Fecha-->


<!-- Contenedor para Datos Adjuntos -->

// Objetos para almacenar las imágenes seleccionadas por vista previa
const selectedFiles = {
    preview1: [],
};

function handleFileInput(event, previewId) {
    const files = event.target.files;
    const previewContainer = document.getElementById(previewId);

    Array.from(files).forEach((file) => {
        const reader = new FileReader();
        reader.onload = function (e) {
            const div = document.createElement("div");
            div.classList.add("image-preview-item");
            div.innerHTML = `
	                    <img src="${e.target.result}" alt="Preview">
	                    <div class="delete-icon" onclick="deleteImage('${previewId}', ${selectedFiles[previewId].length})">×</div>
	                `;
            previewContainer.appendChild(div);

            // Almacena el archivo en la lista correspondiente
            selectedFiles[previewId].push(file);

            // Validar campos después de agregar una imagen
            validatePage(9);

        };
        reader.readAsDataURL(file);
    });

    // Resetea el input para permitir seleccionar los mismos archivos nuevamente si es necesario
    event.target.value = "";
}

function deleteImage(previewId, index) {
    const previewContainer = document.getElementById(previewId);

    // Elimina la imagen de la vista previa
    previewContainer.removeChild(previewContainer.children[index]);

    // Elimina el archivo correspondiente del arreglo
    selectedFiles[previewId].splice(index, 1);
    validatePage(9);

    // Actualiza los índices de las imágenes restantes en la vista previa
    Array.from(previewContainer.children).forEach((child, newIndex) => {
        const deleteIcon = child.querySelector(".delete-icon");
        deleteIcon.setAttribute(
            "onclick",
            `deleteImage('${previewId}', ${newIndex})`
        );
    });
}

// Eventos para manejar las entradas de archivos
document
    .getElementById("adjunto1")
    .addEventListener("change", (e) => handleFileInput(e, "preview1"));

// Funciones para manejar arrastre de archivos
const dragAreas = ["drag-area1"];
dragAreas.forEach((area) => {
    const dragArea = document.getElementById(area);
    dragArea.addEventListener("dragover", (event) => {
        event.preventDefault();
        event.stopPropagation();
        dragArea.style.backgroundColor = "#e0f7ff"; // Resaltar el área
    });

    dragArea.addEventListener("dragleave", (event) => {
        event.preventDefault();
        event.stopPropagation();
        dragArea.style.backgroundColor = "#f0f8ff"; // Restaurar color de fondo
    });

    dragArea.addEventListener("drop", (event) => {
        event.preventDefault();
        event.stopPropagation();
        const files = event.dataTransfer.files;
        const previewId = area.replace("drag-area", "preview");
        handleFileInput({ target: { files } }, previewId);
    });
});

// Definir la función compressImage en el ámbito global
function compressImage(file, quality) {
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = (event) => {
            const img = new Image();
            img.onload = () => {
                const canvas = document.createElement("canvas");
                const ctx = canvas.getContext("2d");

                // Redimensionar imagen
                const maxWidth = 600;
                const scale = maxWidth / img.width;
                canvas.width = maxWidth;
                canvas.height = img.height * scale;

                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                const dataUrl = canvas.toDataURL("image/jpeg", quality);
                resolve(dataUrl);
            };
            img.src = event.target.result;
        };
        reader.onerror = reject;
        reader.readAsDataURL(file);
    });
}


<!-- Contenedor para Datos Adjuntos -->


<!-- Contenedor de Paginación-->

// Obtener referencias a los botones y páginas
const backButton = document.getElementById("back");
const nextButton = document.getElementById("next");
const enviarBtn = document.getElementById("enviarBtn");
const pages = document.querySelectorAll(".container > .form-container > div");
let currentPage = 1; // Comenzar desde la página 1

// Mostrar la página actual
showPage(currentPage);
document.getElementById('adjunto1').addEventListener('change', (e) => handleFileInput(e, 'preview1'));

// Función para validar si todos los campos de la página actual están completos
// Función para validar si todos los campos de la página actual están completos
function validatePage(pageIndex) {
    const currentPageElement = document.getElementById(`page${pageIndex}`);
    const inputs = currentPageElement.querySelectorAll(
        "input, select, textarea"
    );
    let allFieldsValid = true;

    // Validación específica para la página 1 (Fecha y Área)
    if (pageIndex === 1) {
        const fecha = document.getElementById("fecha").value;
        const area = document.getElementById("area").value;

        if (fecha.trim() === "" || area === "Selecciona una opción") {
            allFieldsValid = false;
        }
        return allFieldsValid;
    }

    // Validación para la página 2 (Oficinas)
    if (pageIndex === 2) {
        const calificarOficinas = document.getElementById("calificarOficinas")
            .value;
        const area = document.getElementById("area").value;
        const oficinaAdministracionDiv = document.getElementById(
            "oficinaAdministracion"
        );

        // Mostrar u ocultar el campo "Oficina de Administración" según el área y la respuesta
        if (area === "Administración" && calificarOficinas === "Sí") {
            oficinaAdministracionDiv.style.display = "block"; // Mostrar el campo
        } else {
            oficinaAdministracionDiv.style.display = "none"; // Ocultar el campo
        }

        // Si la respuesta es "No" o está vacía, no se revisan las preguntas dinámicas
        if (calificarOficinas === "No" || calificarOficinas === "") {
            return true; // Permite avanzar sin revisar preguntas dinámicas
        }

        // Si la respuesta es "Sí", se revisan las preguntas dinámicas
        if (calificarOficinas === "Sí") {
            const preguntasDinamicas = currentPageElement.querySelectorAll(
                ".question-container select"
            );
            preguntasDinamicas.forEach((select) => {
                if (select.value === "") {
                    allFieldsValid = false;
                }
            });

            // Si el área es "Administración", se revisa el campo adicional
            if (area === "Administración") {
                const oficina = document.getElementById("oficina").value;
                if (oficina.trim() === "") {
                    allFieldsValid = false;
                }
            }
        }
        return allFieldsValid;
    }

    // Validación para las páginas 3 a 7 (Preguntas principales y dinámicas)
    if (pageIndex >= 3 && pageIndex <= 7) {
        const preguntaPrincipal = currentPageElement.querySelector("select")
            .value;

        // Si la respuesta es "No" o está vacía, no se revisan las preguntas dinámicas
        if (preguntaPrincipal === "No" || preguntaPrincipal === "") {
            return true; // Permite avanzar sin revisar preguntas dinámicas
        }

        // Si la respuesta es "Sí", se revisan las preguntas dinámicas
        if (preguntaPrincipal === "Sí") {
            const preguntasDinamicas = currentPageElement.querySelectorAll(
                ".question-container select"
            );
            preguntasDinamicas.forEach((select) => {
                if (select.value === "") {
                    allFieldsValid = false;
                }
            });
        }
        return allFieldsValid;
    }

    // Validación para la página 9 (Subir imágenes)
    if (pageIndex === 9) {
        const hayImagenAdjunta = document.getElementById('preview1').children.length > 0;

        if (hayImagenAdjunta) {
            enviarBtn.disabled = false; // Habilitar el botón de enviar
        } else {
            enviarBtn.disabled = true; // Deshabilitar el botón de enviar
        }

        return hayImagenAdjunta; // Retornar true si hay imágenes, false si no
    }

    return allFieldsValid;
}

// Función para habilitar o deshabilitar el botón "Siguiente"
function toggleNextButton() {
    const nextButton = document.getElementById("next");
    const isValid = validatePage(currentPage);

    if (isValid) {
        nextButton.disabled = false;
    } else {
        nextButton.disabled = true;
    }
}

// Escuchar cambios en los campos de la página actual
function addInputListeners(pageIndex) {
    const currentPageElement = document.getElementById(`page${pageIndex}`);
    const inputs = currentPageElement.querySelectorAll(
        "input, select, textarea"
    );

    inputs.forEach((input) => {
        input.addEventListener("change", toggleNextButton);
        if (input.tagName === "INPUT" || input.tagName === "TEXTAREA") {
            input.addEventListener("input", toggleNextButton); // Para campos de texto
        }
    });
}

// Mostrar la página actual y agregar listeners
function showPage(pageIndex) {
    const totalPages = 9; // Número total de páginas

    // Ocultar todas las páginas
    pages.forEach((page) => {
        page.classList.add("hidden");
        page.classList.remove("visible");
    });

    // Mostrar la página actual
    const currentPageElement = document.getElementById(`page${pageIndex}`);
    if (currentPageElement) {
        currentPageElement.classList.remove("hidden");
        currentPageElement.classList.add("visible");
    }

    // Control de botones
    backButton.style.display = pageIndex === 1 ? "none" : "inline-block";
    nextButton.style.display =
        pageIndex === totalPages ? "none" : "inline-block";
    enviarBtn.style.display =
        pageIndex === totalPages ? "inline-block" : "none";

    // Deshabilitar el botón "Siguiente" inicialmente
    nextButton.disabled = true;

    // Agregar listeners a los campos de la página actual
    addInputListeners(pageIndex);

    // Validar la página actual para habilitar o deshabilitar el botón "Siguiente"
    toggleNextButton();
}

// Eventos para los botones de navegación
nextButton.addEventListener("click", () => {
    if (currentPage < 9) {
        currentPage++;
        showPage(currentPage);
    }
});

backButton.addEventListener("click", () => {
    if (currentPage > 1) {
        currentPage--;
        showPage(currentPage);
    }
});

<!-- Contenedor de Paginación-->
	

<!-- Contenedor de Paginación - Mostrar / Ocultar Preguntas-->


function toggleQuestions(selectId, sectionId, specificSectionId = null) {
    const selectElement = document.getElementById(selectId);
    const sectionElement = document.getElementById(sectionId);
    const specificSectionElement = specificSectionId
        ? document.getElementById(specificSectionId)
        : null;

    selectElement.addEventListener("change", function () {
        if (this.value === "Sí") {
            sectionElement.style.display = "block";
            if (specificSectionElement) {
                specificSectionElement.style.display = "block";
            }
        } else {
            sectionElement.style.display = "none";
            if (specificSectionElement) {
                specificSectionElement.style.display = "none";
            }
        }
    });
}

// Aplicar la función a cada sección
toggleQuestions(
    "calificarOficinas",
    "questionsSectionOficinas",
    "oficinaAdministracion"
);
toggleQuestions("calificarPasillos", "questionsSectionPasillos");
toggleQuestions("calificarFood", "questionsSectionFood");
toggleQuestions("calificarBano", "questionsSectionBano");
toggleQuestions("calificarAlrededor", "questionsSectionAlrededor");
toggleQuestions("calificarPractica", "questionsSectionPractica");


<!-- Contenedor de Paginación - Mostrar / Ocultar Preguntas-->


<!-- Contenedor de Generación de Preguntas-->


const questionsOficinas = [
    {
        id: "question1",
        text: "¿Se observa presencia de telas de araña?",
        options: ["Sí", "No"],
    },
    {
        id: "question2",
        text:
            "¿Los escritorios, mesas, estantes, archiveros y demás superficies de trabajo están limpios?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question3",
        text:
            "¿Los dispositivos electrónicos compartidos (teléfonos, teclados, computadoras y otros) están limpios?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question4",
        text:
            "¿Las superficies de contacto frecuente (manijas, interruptores, pasamanos) están limpias y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question5",
        text: "¿El oasis se encuentra limpio y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question6",
        text: "¿El microondas se encuentra limpio y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question7",
        text: "¿Las cafeteras se encuentra limpias y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question8",
        text: "¿Las refrigeradoras se encuentra limpias y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question9",
        text: "¿Las ventanas y demás vidrios se encuentran limpios?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question10",
        text: "¿Las puertas se encuentran limpias y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question11",
        text: "¿Las sillas están limpias (Sin polvo y patas limpias)?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question12",
        text: "¿El piso está limpio y sin manchas visibles?",
        options: ["Sí", "No"],
    },
    {
        id: "question13",
        text:
            "¿Los basureros se encuentran limpios y con su respectiva bolsa de basura?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question14",
        text:
            "¿Los dispensadores (papel toalla, jabón, gel) están limpios, abastecidos y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question15",
        text: "¿El área se encuentra aromatizada?",
        options: ["Sí", "No"],
    },
];


const questionsPasillos = [
    {
        id: "question16",
        text: "¿Se observa presencia de telas de araña?",
        options: ["Sí", "No"],
    },
    {
        id: "question17",
        text:
            "¿Las superficies de contacto frecuente (manijas, interruptores, pasamanos) están limpias y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question18",
        text: "¿Las ventanas y demás vidrios se encuentran limpios?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question19",
        text: "¿Los extintores se encuentran limpios?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question20",
        text: "¿El piso está limpio y sin manchas visibles?",
        options: ["Sí", "No"],
    },
    {
        id: "question21",
        text:
            "¿Los basureros se encuentran limpios y con su respectiva bolsa de basura?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question22",
        text:
            "¿Los dispensadores (papel toalla, jabón, gel) están limpios, abastecidos y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question23",
        text: "¿Las cafeteras se encuentra limpias y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question24",
        text: "¿El área se encuentra aromatizada?",
        options: ["Sí", "No"],
    },
];


const questionsFood = [
    {
        id: "question25",
        text: "¿Se observa presencia de telas de araña?",
        options: ["Sí", "No"],
    },
    {
        id: "question26",
        text:
            "¿Las superficies de contacto frecuente (manijas, interruptores, pasamanos) están limpias y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question27",
        text: "¿El oasis se encuentra limpio y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question28",
        text: "¿El microondas se encuentra limpio y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question29",
        text: "¿Las cafeteras se encuentra limpias y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question30",
        text: "¿Las refrigeradoras se encuentra limpias y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question31",
        text: "¿Las ventanas y demás vidrios se encuentran limpios?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question32",
        text: "¿Las sillas están limpias (Sin polvo y patas limpias)?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question33",
        text: "¿Las mesas están limpias?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question34",
        text: "¿El piso está limpio y sin manchas visible?",
        options: ["Sí", "No"],
    },
    {
        id: "question35",
        text:
            "¿Los basureros se encuentran limpios y con su respectiva bolsa de basura?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question36",
        text:
            "¿Los dispensadores (papel toalla, jabón, gel) están limpios, abastecidos y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question37",
        text: "¿El área se encuentra aromatizada?",
        options: ["Sí", "No"],
    },
];


const questionsBano = [
    {
        id: "question38",
        text: "¿El área se encuentra aromatizada?",
        options: ["Sí", "No"],
    },
    {
        id: "question39",
        text: "¿Se observa presencia de telas de araña?",
        options: ["Sí", "No"],
    },
    {
        id: "question40",
        text: "¿Los pisos están limpios?",
        options: ["Sí", "No"],
    },
    {
        id: "question41",
        text: "¿Las ventanas y demás vidrios se encuentran limpios?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question42",
        text: "¿Las paredes se encuentran limpias y sin manchas visibles?",
        options: ["Sí", "No"],
    },
    {
        id: "question43",
        text: "¿Las puertas se encuentran limpias y sin manchas visibles?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question44",
        text:
            "¿Las divisiones (puertas / acrílicos, etc) se encuentran limpias y sin manchas visibles?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question45",
        text:
            "¿Los lavamanos están limpios, libres de sarro y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question46",
        text: "¿Los espejos están limpios y sin presencia de manchas?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question47",
        text:
            "¿Los sanitarios están limpios, libres de sarro y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question48",
        text:
            "¿Los urinarios están limpios, libres de sarro y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question49",
        text: "¿Las duchas están limpias, libres de sarro y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question50",
        text:
            "¿Los basureros se encuentran limpios y con su respectiva bolsa de basura?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question51",
        text:
            "¿Los dispensadores (papel toalla, jabón, gel) están limpios, abastecidos y en funcionamiento?",
        options: ["Sí", "No", "N/A"],
    },
];


const questionsAlrededor = [
    {
        id: "question52",
        text:
            "¿Las áreas exteriores, incluyendo aceras, entradas se encuentran limpias?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question53",
        text: "¿Las pilas / piletas se encuentran limpias y en buen estado?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question54",
        text: "¿Hay presencia de basura, hojas u otros desechos en el suelo?",
        options: ["Sí", "No"],
    },
    {
        id: "question55",
        text: "¿Los contenedores de basura están saturados de basura?",
        options: ["Sí", "No", "N/A"],
    },
    {
        id: "question56",
        text: "¿Las paredes se encuentran limpias y sin manchas visibles?",
        options: ["Sí", "No"],
    },
    {
        id: "question57",
        text: "¿Las ventanas y demás vidrios se encuentran limpios?",
        options: ["Sí", "No", "N/A"],
    },
];


const questionsPractica = [
    {
        id: "question58",
        text:
            "¿El personal está cumpliendo con la ejecución y el llenado de los reportes diarios en áreas y baños?",
        options: ["Sí", "No"],
    },
    {
        id: "question59",
        text:
            "¿El personal asignado está haciendo buen uso del equipo de protección?",
        options: ["Sí", "No"],
    },
    {
        id: "question60",
        text:
            '¿El personal asignado está utilizando correctamente el rótulo de "Limpieza en progreso" durante sus actividades?',
        options: ["Sí", "No"],
    },
    {
        id: "question61",
        text:
            "¿Se respeta la codificación de colores en los paños de microfibra para evitar la contaminación cruzada?",
        options: ["Sí", "No"],
    },
    {
        id: "question62",
        text:
            "¿Se respeta la codificación de colores en las mechas de trapeador para evitar la contaminación cruzada?",
        options: ["Sí", "No"],
    },
    {
        id: "question63",
        text:
            "¿El personal asignado está utilizando adecuadamente las herramientas de limpieza durante su manipulación?",
        options: ["Sí", "No"],
    },
    {
        id: "question64",
        text:
            "¿El personal asignado está utilizando los productos químicos de forma segura?",
        options: ["Sí", "No"],
    },
    {
        id: "question65",
        text:
            "¿Se almacena correctamente el equipo de limpieza, ordenado y sin restos de suciedad?",
        options: ["Sí", "No"],
    },
    {
        id: "question66",
        text:
            "¿Hay alguna herramienta que muestre signos de deterioro o desgaste que puedan afectar su funcionamiento?",
        options: ["Sí", "No"],
    },
    {
        id: "question67",
        text:
            "¿Todas las herramientas cuentan con un etiquetado claro y legible que facilite su identificación?",
        options: ["Sí", "No"],
    },
];


const questionsSectionOficinas = document.getElementById("questionsSectionOficinas");
const questionsSectionPasillos = document.getElementById("questionsSectionPasillos");
const questionsSectionFood = document.getElementById("questionsSectionFood");
const questionsSectionBano = document.getElementById("questionsSectionBano");
const questionsSectionAlrededor = document.getElementById("questionsSectionAlrededor");
const questionsSectionPractica = document.getElementById("questionsSectionPractica");

// Generar preguntas dinámicamente para oficinas
questionsOficinas.forEach((q) => {
    const questionContainer = document.createElement("div");
    questionContainer.classList.add("question-container");
    const label = document.createElement("label");
    label.setAttribute("for", q.id);
    label.textContent = q.text;
    questionContainer.appendChild(label);

    const select = document.createElement("select");
    select.id = q.id;
    select.name = q.id;
    select.innerHTML =
        '<option value="">Selecciona una opción</option>' +
        q.options
            .map((option) => `<option value="${option}">${option}</option>`)
            .join("");
    questionContainer.appendChild(select);

    questionsSectionOficinas.appendChild(questionContainer);
});

// Generar preguntas dinámicamente para pasillos
questionsPasillos.forEach((q) => {
    const questionContainer = document.createElement("div");
    questionContainer.classList.add("question-container");
    const label = document.createElement("label");
    label.setAttribute("for", q.id);
    label.textContent = q.text;
    questionContainer.appendChild(label);

    const select = document.createElement("select");
    select.id = q.id;
    select.name = q.id;
    select.innerHTML =
        '<option value="">Selecciona una opción</option>' +
        q.options
            .map((option) => `<option value="${option}">${option}</option>`)
            .join("");
    questionContainer.appendChild(select);

    questionsSectionPasillos.appendChild(questionContainer);
});

// Generar preguntas dinámicamente para Food Court / Área de Comida
questionsFood.forEach((q) => {
    const questionContainer = document.createElement("div");
    questionContainer.classList.add("question-container");
    const label = document.createElement("label");
    label.setAttribute("for", q.id);
    label.textContent = q.text;
    questionContainer.appendChild(label);

    const select = document.createElement("select");
    select.id = q.id;
    select.name = q.id;
    select.innerHTML =
        '<option value="">Selecciona una opción</option>' +
        q.options
            .map((option) => `<option value="${option}">${option}</option>`)
            .join("");
    questionContainer.appendChild(select);

    questionsSectionFood.appendChild(questionContainer);
});

// Generar preguntas dinámicamente para Baños
questionsBano.forEach((q) => {
    const questionContainer = document.createElement("div");
    questionContainer.classList.add("question-container");
    const label = document.createElement("label");
    label.setAttribute("for", q.id);
    label.textContent = q.text;
    questionContainer.appendChild(label);

    const select = document.createElement("select");
    select.id = q.id;
    select.name = q.id;
    select.innerHTML =
        '<option value="">Selecciona una opción</option>' +
        q.options
            .map((option) => `<option value="${option}">${option}</option>`)
            .join("");
    questionContainer.appendChild(select);

    questionsSectionBano.appendChild(questionContainer);
});

// Generar preguntas dinámicamente para Alrededores
questionsAlrededor.forEach((q) => {
    const questionContainer = document.createElement("div");
    questionContainer.classList.add("question-container");
    const label = document.createElement("label");
    label.setAttribute("for", q.id);
    label.textContent = q.text;
    questionContainer.appendChild(label);

    const select = document.createElement("select");
    select.id = q.id;
    select.name = q.id;
    select.innerHTML =
        '<option value="">Selecciona una opción</option>' +
        q.options
            .map((option) => `<option value="${option}">${option}</option>`)
            .join("");
    questionContainer.appendChild(select);

    questionsSectionAlrededor.appendChild(questionContainer);
});

// Generar preguntas dinámicamente para las buenas prácticas
questionsPractica.forEach((q) => {
    const questionContainer = document.createElement("div");
    questionContainer.classList.add("question-container");
    const label = document.createElement("label");
    label.setAttribute("for", q.id);
    label.textContent = q.text;
    questionContainer.appendChild(label);

    const select = document.createElement("select");
    select.id = q.id;
    select.name = q.id;
    select.innerHTML =
        '<option value="">Selecciona una opción</option>' +
        q.options
            .map((option) => `<option value="${option}">${option}</option>`)
            .join("");
    questionContainer.appendChild(select);

    questionsSectionPractica.appendChild(questionContainer);
});


<!-- Contenedor de Generación de Preguntas-->


<!-- Contenedor para Confirmar Envío-->


function confirmarEnvio() {
    Swal.fire({
        text: "¿Estás seguro de continuar? 🤔",
        icon: "question",
        showCancelButton: true,
        confirmButtonText: "Sí 🫡",
        cancelButtonText: "No 😬",
        customClass: {
            popup: "swal-popup", // Clase para el modal
            confirmButton: "swal-button", // Clase para el botón de confirmación
            cancelButton: "swal-button-cancel", // Clase para el botón de cancelación
            actions: "swal-actions", // Clase para el contenedor de los botones
        },
    }).then((result) => {
        if (result.isConfirmed) {
            // Mostrar el overlay de "Procesando..."
            document.getElementById("overlay").style.display = "flex";
            enviarDatos();
        }
    });
}


<!-- Contenedor para Confirmar Envío-->


<!-- Contenedor para EnviarDatos-->


async function enviarDatos() {
    try {
        // Obtener valores del formulario
        const fecha = document.getElementById("fecha").value;
        const comentarios = document.getElementById("comentarios").value;

        // Crear el PDF
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF({ format: "letter" });
        const pageWidth = pdf.internal.pageSize.getWidth();
        const pageHeight = pdf.internal.pageSize.getHeight();

        // Definir la función imageToBase64 tal como la compartiste
        function imageToBase64(imgPath, callback) {
            const reader = new FileReader();
            reader.onload = function (e) {
                callback(e.target.result);
            };
            fetch(imgPath)
                .then((response) => response.blob())
                .then((blob) => reader.readAsDataURL(blob))
                .catch((error) => console.error("Error al convertir a base64:", error));
        }

        // Crear una promesa para usar await con tu función imageToBase64
        function getLogoBase64(imgPath) {
            return new Promise((resolve, reject) => {
                imageToBase64(imgPath, function (base64) {
                    resolve(base64);
                });
            });
        }

        // Convertir la imagen del logo a base64 usando tu función
        const logoBase64 = await getLogoBase64("Imágenes/Icono.png");

        // Función para agregar texto con manejo de nuevas páginas
        function addTextWithPageBreak(text, x, y, options = {}) {
            const lineHeight = 10; // Altura de línea
            const marginBottom = 10; // Margen inferior
            let currentY = y;

            // Dividir el texto en líneas
            const lines = pdf.splitTextToSize(
                text,
                options.maxWidth || pageWidth - x - 10
            );

            // Agregar cada línea al PDF
            lines.forEach((line) => {
                if (currentY + lineHeight > pageHeight - marginBottom) {
                    pdf.addPage(); // Agregar nueva página
                    currentY = 20; // Reiniciar la posición Y en la nueva página
                }
                pdf.text(line, x, currentY);
                currentY += lineHeight; // Mover a la siguiente línea
            });

            return currentY; // Devolver la posición Y final
        }

        // Portada
        pdf.setFont("times", "bold");
        pdf.setFontSize(16);

        // Agregar el logo (usando la cadena base64 generada automáticamente)
        pdf.addImage(logoBase64, "PNG", 10, 10, 50, 50); // Ajusta las coordenadas y el tamaño según sea necesario

        // Título del reporte
        pdf.setFontSize(24);
        pdf.text("Reporte de Supervisión", pageWidth / 2, 30, { align: "center" });

        // Información del proyecto
        pdf.setFontSize(16);
        pdf.text("Proyecto: Cementera Argos", pageWidth / 2, 50, { align: "center" });
        pdf.text("Nombre del Supervisor: Jeancarlo Zelaya", pageWidth / 2, 65, { align: "center" });
        pdf.text("Correo: jromero@grupomacdel.com", pageWidth / 2, 80, { align: "center" });
        pdf.text("Actividad: Supervisión de Áreas (Específico)", pageWidth / 2, 95, { align: "center" });

        // Línea horizontal
        pdf.line(10, 105, pageWidth - 10, 105);

        // Fecha y firma
        pdf.text(`Fecha: ${fecha}`, 10, 115);
        pdf.text(
            "Área a Supervisar: " + document.getElementById("area").value,
            10,
            130
        );

        // Si oficina no está vacía, agregarla
        let oficinaValue = document.getElementById("oficina").value;
        if (oficinaValue !== "") {
            pdf.text("Oficina: " + oficinaValue, 10, 145);
            yPosition = 160;
        } else {
            yPosition = 145;
        }

        // Comentarios (filtrados de emoticones)
        if (comentarios && comentarios.trim() !== "") {
            const comentariosFiltrada = comentarios.replace(
                /[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}\u{1F900}-\u{1F9FF}\u{1FA70}-\u{1FAFF}\u{200D}\u{FE0F}]/gu,
                ""
            );
            if (comentariosFiltrada.trim() !== "") {
                pdf.setFont("times", "bold");
                yPosition = addTextWithPageBreak(`Comentarios:`, 10, yPosition);
                pdf.setFont("times", "normal");
                yPosition = addTextWithPageBreak(
                    comentariosFiltrada,
                    15,
                    yPosition + 5,
                    { maxWidth: 190 }
                );
            }
        }


        // Recopilar respuestas de las páginas 2 a 7
        const respuestas = recopilarRespuestas();

        // Agregar respuestas al PDF
        if (Object.keys(respuestas).length > 0) {
            for (const [seccion, preguntas] of Object.entries(respuestas)) {
                // Agregar nueva página para cada sección
                pdf.addPage();
                pdf.setFont("times", "bold");
                pdf.setFontSize(16);
                pdf.text(`${seccion}:`, 10, 20);
                pdf.line(10, 23, 190, 23);

                // Crear datos para la tabla
                const tableData = preguntas.map((r) => [
                    r.pregunta, // Columna de preguntas
                    r.si, // Columna de Sí
                    r.no, // Columna de No
                    r.na, // Columna de N/A
                ]);

                // Configurar la tabla
                pdf.autoTable({
                    startY: 30, // Posición Y inicial de la tabla
                    head: [["Pregunta", "Sí", "No", "N/A"]], // Encabezados de la tabla
                    body: tableData, // Datos de la tabla
                    theme: "grid", // Estilo de la tabla (grid, striped, plain)
                    headStyles: {
                        fillColor: [41, 128, 185], // Color de fondo del encabezado
                        textColor: [255, 255, 255], // Color del texto del encabezado
                        fontStyle: "bold", // Negrita para el encabezado
                        halign: "center", // Centrar texto horizontalmente
                        valign: "middle", // Centrar texto verticalmente
                    },
                    bodyStyles: {
                        textColor: [0, 0, 0], // Color del texto del cuerpo
                        fontStyle: "normal", // Estilo normal para el cuerpo
                        valign: "middle", // Centrar texto verticalmente
                    },
                    columnStyles: {
                        0: { cellWidth: "auto", fontStyle: "bold" }, // Pregunta en negrita
                        1: {
                            cellWidth: 20,
                            halign: "center",
                            valign: "middle",
                        }, // Sí (ancho fijo y centrado)
                        2: {
                            cellWidth: 20,
                            halign: "center",
                            valign: "middle",
                        }, // No (ancho fijo y centrado)
                        3: {
                            cellWidth: 20,
                            halign: "center",
                            valign: "middle",
                        }, // N/A (ancho fijo y centrado)
                    },
                    margin: { top: 30 }, // Margen superior
                });
            }
        }

        // Manejar datos adjuntos (imágenes)
        for (let i = 1; i <= 1; i++) {
            const input = document.getElementById(`adjunto${i}`);
            if (selectedFiles[`preview${i}`].length > 0) {
                const files = selectedFiles[`preview${i}`];
                let imgCount = 0;

                // Comenzar una nueva página al principio de cada conjunto de imágenes
                pdf.addPage();
                pdf.setFont("times", "bold"); // Cambiar a Times y negrita

                // Establecer el título según el grupo de imágenes (Antes, Durante, Después)
                let sectionTitle = "";
                if (i === 1) {
                    sectionTitle = "Evidencia:";
                }

                // Agregar el título correspondiente
                pdf.text(sectionTitle, 10, 15);

                const imgWidth = 60; // Ancho de imagen ajustado
                const imgHeight = 40; // Alto de imagen ajustado
                const marginX = 15; // Margen izquierdo
                const marginY = 20; // Margen superior
                const spacingX = 65; // Espacio entre columnas
                const spacingY = 45; // Espacio entre filas
                const pageHeight = pdf.internal.pageSize.height; // Altura de la página

                // Iterar a través de las imágenes
                for (let j = 0; j < files.length; j++) {
                    const file = files[j];
                    const imgData = await compressImage(file, 0.5); // Comprimir imagen

                    // Calcular la posición X y Y para la imagen
                    const x = (imgCount % 3) * spacingX + marginX; // Posición X
                    const y = Math.floor(imgCount / 3) * spacingY + marginY; // Posición Y

                    // Verificar si la imagen se sale de los márgenes de la página
                    if (y + imgHeight > pageHeight - marginY) {
                        // Añadir nueva página si se excede el espacio
                        pdf.addPage();
                        pdf.text(`Continuación datos adjuntos #${i}:`, 10, 10);
                        imgCount = 0; // Reiniciar el conteo para la nueva página
                    }

                    // Añadir la imagen a la página
                    pdf.addImage(imgData, "JPEG", x, y, imgWidth, imgHeight);
                    imgCount++;

                    // Si imgCount llega a 15, reiniciar
                    if (imgCount === 15) {
                        imgCount = 0; // Reiniciar el conteo de imágenes para la siguiente página

                        // Solo añadir una nueva página si hay más de 15 imágenes
                        if (
                            selectedFiles[`preview${i}`].length % 15 !== 0 &&
                            selectedFiles[`preview${i}`].length > 0
                        ) {
                            pdf.addPage(); // Añadir nueva página

                            // Establecer el título de la nueva página según la sección
                            let sectionTitle = "";
                            if (i === 1) {
                                sectionTitle = "Evidencia:";
                            }

                            // Añadir un encabezado a la nueva página
                            pdf.text(sectionTitle, 10, 15);
                        }
                    }
                }
            }
        }

        let area = document.getElementById('area').value;
        let oficina = document.getElementById('oficina').value;

        // Crear un nombre para el archivo basado en la fecha y el área
        let nombreArchivo = `${fecha} - Reporte de Supervisión - ${area}`;

        // Si el área es "Administración" y hay una oficina especificada, agregarla al nombre
        if (area === "Administración" && oficina) {
            nombreArchivo += ` - ${oficina}`;
        }

        // Agregar la extensión .pdf al nombre del archivo
        nombreArchivo += ".pdf";

        // Convertir el PDF generado a base64
        const pdfBase64 = pdf.output("datauristring").split(",")[1];

        // Enviar el archivo al script de Google Apps
        const response = await fetch(
            "https://script.google.com/macros/s/AKfycbyhOCwHZ_SVtrxwNwVJ59MHg6KtB7TEKd5sdFf-KphdRWXi8HUyMfIOamvnUkHFQ1_9/exec",
            {
                method: "POST",
                body: new URLSearchParams({
                    pdfFile: pdfBase64,
                    fileName: nombreArchivo,
                }),
            }
        );

        const result = await response.text();
        console.log("Archivo guardado con ID:", result);

        // Ocultar el overlay de "Procesando..."
        document.getElementById("overlay").style.display = "none";

        // Mostrar mensaje de éxito con SweetAlert2
        Swal.fire({
            text: "¡Envío exitoso! 🥳🎉",
            icon: "success",
            showCancelButton: false, // No mostrar el botón de cancelar
            confirmButtonText: "Aceptar",
            customClass: {
                content: "swal-content",
                confirmButton: "swal-button",
                popup: "swal-popup",
            },
            footer:
                '<button id="descargar-pdf" class="swal-button">Descargar PDF</button>', // Botón personalizado
        }).then((result) => {
            if (result.isConfirmed) {
                // Si el usuario hace clic en "Aceptar", recargar la página
            }
        });

        // Agregar un evento al botón personalizado para descargar el PDF
        document.addEventListener("click", (event) => {
            if (event.target && event.target.id === "descargar-pdf") {
                pdf.save(nombreArchivo); // Descargar el PDF
            }
        });
    } catch (error) {
        console.error("Error al enviar los datos:", error);

        // Ocultar el overlay de "Procesando..."
        document.getElementById("overlay").style.display = "none";

        // Mostrar mensaje de error con SweetAlert2
        Swal.fire({
            text:
                "Hubo un problema al enviar los datos. Intenta nuevamente. 😢",
            icon: "error",
            confirmButtonText: "Aceptar",
            customClass: {
                content: "swal-content",
                confirmButton: "swal-button",
                popup: "swal-popup",
            },
        });
    }
}


function recopilarRespuestas() {
    const respuestas = {};

    // Recopilar respuestas de la página 2 (Oficinas)
    if (document.getElementById("calificarOficinas").value === "Sí") {
        respuestas["Oficinas"] = questionsOficinas.map((q) => {
            const respuesta = document.getElementById(q.id).value;
            return {
                pregunta: q.text,
                si: respuesta === "Sí" ? "X" : "",
                no: respuesta === "No" ? "X" : "",
                na: respuesta === "N/A" ? "X" : "",
            };
        });
    }

    // Recopilar respuestas de la página 3 (Pasillos)
    if (document.getElementById("calificarPasillos").value === "Sí") {
        respuestas["Pasillos"] = questionsPasillos.map((q) => {
            const respuesta = document.getElementById(q.id).value;
            return {
                pregunta: q.text,
                si: respuesta === "Sí" ? "X" : "",
                no: respuesta === "No" ? "X" : "",
                na: respuesta === "N/A" ? "X" : "",
            };
        });
    }

    // Recopilar respuestas de la página 4 (Food Court / Área de Comida)
    if (document.getElementById("calificarFood").value === "Sí") {
        respuestas["Food Court / Área de Comida"] = questionsFood.map((q) => {
            const respuesta = document.getElementById(q.id).value;
            return {
                pregunta: q.text,
                si: respuesta === "Sí" ? "X" : "",
                no: respuesta === "No" ? "X" : "",
                na: respuesta === "N/A" ? "X" : "",
            };
        });
    }

    // Recopilar respuestas de la página 5 (Baños)
    if (document.getElementById("calificarBano").value === "Sí") {
        respuestas["Baños"] = questionsBano.map((q) => {
            const respuesta = document.getElementById(q.id).value;
            return {
                pregunta: q.text,
                si: respuesta === "Sí" ? "X" : "",
                no: respuesta === "No" ? "X" : "",
                na: respuesta === "N/A" ? "X" : "",
            };
        });
    }

    // Recopilar respuestas de la página 6 (Alrededores)
    if (document.getElementById("calificarAlrededor").value === "Sí") {
        respuestas["Alrededores"] = questionsAlrededor.map((q) => {
            const respuesta = document.getElementById(q.id).value;
            return {
                pregunta: q.text,
                si: respuesta === "Sí" ? "X" : "",
                no: respuesta === "No" ? "X" : "",
                na: respuesta === "N/A" ? "X" : "",
            };
        });
    }

    // Recopilar respuestas de la página 7 (Buenas Prácticas)
    if (document.getElementById("calificarPractica").value === "Sí") {
        respuestas["Buenas Prácticas"] = questionsPractica.map((q) => {
            const respuesta = document.getElementById(q.id).value;
            return {
                pregunta: q.text,
                si: respuesta === "Sí" ? "X" : "",
                no: respuesta === "No" ? "X" : "",
                na: respuesta === "N/A" ? "X" : "",
            };
        });
    }

    return respuestas;
}


<!-- Contenedor para EnviarDatos-->
	
	
</script>
</body>
</html>
