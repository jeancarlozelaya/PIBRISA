<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Reporte de Supervisi칩n</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
<style>


    /* Evita el desplazamiento horizontal y asegura que el body ocupe el 100% del viewport */
    body, html {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f9f9f9;
        color: #333;
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
        width: 100%;
        max-width: 100%;
        overflow-x: hidden; /* Oculta el desplazamiento horizontal */
    }

    /* Header */
    .header {
        background-color: #007BFF;
        color: white;
        text-align: center;
        padding: 15px;
        width: 100%;
        font-size: 1.5em;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        box-sizing: border-box; /* Asegura que el padding no exceda el ancho */
    }

    /* Contenedor del formulario */
    .container {
        background: #ffffff;
        padding: 20px;
        border-radius: 10px;
        width: 90%;
        max-width: 600px;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
        margin-top: 20px;
        text-align: center;
        margin: 40px auto;
        grid-row: 2;
        height: auto;
        box-sizing: border-box; /* Incluye el padding en el ancho total */
    }

    h1 {
        text-align: center;
        color: #333;
        margin: 0 0 20px 0; /* Ajusta el margen inferior */
    }

    label {
        display: block;
        margin-top: 10px;
        font-weight: bold;
    }

    input[type="date"],
    input[type="time"],
    textarea,
    select,
    #oficina,
    button {
        width: 100%;
        margin-top: 5px;
        padding: 10px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-sizing: border-box; /* Incluye el padding en el ancho total */
    }

    button {
        background-color: #007bff;
        color: #fff;
        border: none;
        cursor: pointer;
        padding: 12px 0;
    }

    button:hover {
        background-color: #0056b3;
    }

    /* Estilo para el bot칩n "Volver al Inicio" */
    .back-button {
        display: inline-block;
        padding: 10px 20px;
        background-color: #007BFF;
        color: white;
        border-radius: 5px;
        text-decoration: none;
        text-align: center;
        font-size: 1em;
        transition: background-color 0.3s, transform 0.3s;
        position: fixed;
        top: 80px;
        left: 0px;
        z-index: 1001;
        box-sizing: border-box; /* Incluye el padding en el ancho total */
    }

    .back-button:hover {
        background-color: #0056b3;
        transform: scale(1.05);
    }

    /* Estilo para los contenedores de preguntas */
    .question-container {
        margin-bottom: 20px;
        text-align: left;
        padding: 10px;
        border: 2px solid #ccc;
        border-radius: 5px;
        background-color: #f9f9f9;
        transition: border-color 0.3s;
        box-sizing: border-box; /* Incluye el padding en el ancho total */
    }

    .question-container:hover {
        border-color: #007BFF;
    }

    .question-container input[type="date"],
    .question-container input[type="time"],
    .question-container textarea,
    .question-container oficina,
    .question-container select {
        padding: 10px;
        border: 2px solid #ccc;
        border-radius: 5px;
        width: 100%;
        font-size: 16px;
        background-color: #f9f9f9;
        color: #333;
        transition: border-color 0.3s;
        box-sizing: border-box; /* Incluye el padding en el ancho total */
        margin-top: 5px;
    }

    .question-container input[type="date"]:focus,
    .question-container input[type="time"]:focus,
    .question-container textarea:focus,
    .question-container oficina:focus,
    .question-container select:focus {
        border-color: #007BFF;
        outline: none;
    }


    /* Estilo del overlay (pantalla bloqueada */


    #overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
    }

    #loadingMessage {
        color: white;
        font-size: 24px;
        font-family: 'Times New Roman', Times, serif;
        text-align: center;
        padding: 20px;
    }


    /* Estilo del overlay (pantalla bloqueada */


    /* Estilo para Mensajes */


    .swal-actions {
        display: flex; /* Coloca los botones en una fila */
        justify-content: center; /* Centra los botones horizontalmente */
        gap: 10px; /* Espacio entre los botones */
    }


    /* Estilo personalizado para el contenido del mensaje */
    .swal-content {
        font-size: 0.9em;  /* Reduce el tama침o del texto */
        line-height: 1.4;  /* Ajusta el espaciado entre l칤neas */
    }

    /* Estilo personalizado para ambos botones */
    .swal-button, .swal-button-cancel {
        font-size: 0.9em;  /* Ajusta el tama침o del texto del bot칩n */
        padding: 10px 20px;  /* Espaciado interno */
        min-width: 100px;  /* Ancho m칤nimo para igualar botones */
        text-align: center;  /* Centra el texto dentro del bot칩n */
    }

    /* Estilo personalizado para el popup/modal */
    .swal-popup {
        width: 300px;  /* Ajusta el ancho m치ximo del modal */
        max-width: 90%;  /* Permite que el modal sea flexible en pantallas peque침as */
    }

    /* Opcional: colores espec칤ficos para cada bot칩n */
    .swal-button {
        background-color: #28a745;  /* Verde para el bot칩n de "S칤" */
        color: white;  /* Texto en blanco */
        border: none;
        border-radius: 4px;
    }

    .swal-button-cancel {
        background-color: #FF6347 ;  /* Rojo para el bot칩n de "No" */
        color: white;  /* Texto oscuro */
        border: none;
        border-radius: 4px;
    }

    .swal2-actions {
        display: flex !important;  /* Asegura que los botones est칠n en una fila */
        justify-content: center;   /* Centra los botones horizontalmente */
        gap: 10px;                 /* Agrega espacio entre los botones */
        flex-wrap: nowrap;         /* Evita que los botones se apilen en dos filas */
    }


    /* Estilo para Mensajes */


    /* Estilo para Datos Adjuntos */


    .image-preview {
        width: 100%;
        max-height: 200px;
        overflow-y: auto;
        border: 0px solid #ccc;
        padding: 10px;
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        box-sizing: border-box;
    }

    .image-preview-item {
        position: relative;
        width: 85px;
        height: 85px;
        overflow: hidden;
        border-radius: 5px;
        border: 1px solid #ddd;
    }

    .image-preview-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .delete-icon {
        position: absolute;
        top: 5px;
        left: 5px;
        width: 20px;
        height: 20px;
        background: rgba(255, 0, 0, 0.8);
        color: #fff;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        cursor: pointer;
        opacity: 0;
        transition: opacity 0.3s;
    }

    .image-preview-item:hover .delete-icon {
        opacity: 1;
    }

    /* Estilos para el 치rea de carga de im치genes */
    .file-upload {
        display: block;
        position: relative;
        width: 100%;
        padding: 20px;
        background: #f0f8ff;
        border: 2px dashed #ccc;
        text-align: center;
        border-radius: 5px;
        font-size: 16px;
        cursor: pointer;
        margin-top: 10px;
        box-sizing: border-box;
        border: 2px dashed #007BFF;
        border-radius: 10px;
        padding: 40px 20px;
        text-align: center;
        cursor: pointer;
        font-size: 16px;
        background-color: #f0f8ff;
        color: #007BFF;
        transition: background-color 0.3s ease, border-color 0.3s ease;
        margin: 10px 0;
    }

    .file-upload:hover {
        border-color: #0056b3;
    }

    .file-upload input[type="file"] {
        display: none;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        cursor: pointer;
    }


    /* Estilo para Datos Adjuntos */


    /* Estilo para Mostrar/Ocultar Paginaci칩n */


    /* Clase para ocultar las p치ginas */
        .hidden {
        display: none;
    }

    /* Clase para mostrar la p치gina actual */
        .visible {
        display: block;
    }


    /* Estilo para Mostrar/Ocultar Paginaci칩n */


    /* Estilo para Botones, Habilitar/Deshabilitar*/


    #enviarBtn,
    #next {
        background-color: #007bff; /* Color azul */
        color: white;
        border: none;
        cursor: pointer;
        padding: 12px 0;
        font-size: 16px;
        border-radius: 5px;
        transition: background-color 0.3s ease, opacity 0.3s ease;
    }

    /* Estilo para el bot칩n de enviar cuando est치 deshabilitado */
    #enviarBtn:disabled,
    #next:disabled {
        background-color: #ccc; /* Color gris */
        color: #666666; /* Texto gris oscuro */
        cursor: not-allowed; /* Cambia el cursor a "no permitido" */
        opacity: 0.7; /* Reduce la opacidad para dar un aspecto deshabilitado */
    }

    /* Efecto hover solo cuando el bot칩n est치 habilitado */
        #enviarBtn:not(:disabled):hover,
        #next:not(:disabled):hover {
        background-color: #0056b3; /* Color azul m치s oscuro al pasar el mouse */
    }


    /* Estilo para Botones, Habilitar/Deshabilitar*/


    /* Estilo para Botones, Misma Linea*/


    /* Contenedor flexible para los botones */
    .botones-container {
        display: flex; /* Hace que los botones est칠n en la misma l칤nea */
        justify-content: space-between; /* Espacio entre los botones */
        gap: 10px; /* Espacio entre los botones */
        margin-top: 20px; /* Margen superior para separar del contenido anterior */
    }

    /* Estilo para los botones dentro del contenedor */
    .botones-container button {
        flex: 1; /* Hace que los botones ocupen el espacio disponible */
        margin: 0; /* Elimina el margen predeterminado */
    }


    /* Estilo para Botones, Misma Linea*/


</style>


</head>


<body>
    <div class="header">
        Pisos Brillantes
    </div>
    <a href="javascript:void(0);" class="back-button" onclick="goBack()">Volver al Inicio</a>
    <div class="container">
        <h1>Reporte de Supervisi칩n de 츼reas</h1>
        <div class="form-container">

            <!-- P치gina 1: Ingreso de Fecha y 츼rea -->
            <div id="page1">
                <div class="question-container">
                    <label for="fecha">Fecha:</label>
                    <input type="date" id="fecha" name="fecha" required>
                </div>

                <div class="question-container">
                    <label for="area">츼rea:</label>
                    <select id="area">
                        <option value="Selecciona una opci칩n">Selecciona una opci칩n</option>
                        <option value="Administraci칩n">Administraci칩n</option>
                        <option value="Almac칠n General">Almac칠n General</option>
                        <option value="Ba침os de Administraci칩n (Hombres)">Ba침os de Administraci칩n (Hombres)</option>
                        <option value="Ba침os de Administraci칩n (Mujeres)">Ba침os de Administraci칩n (Mujeres)</option>
                        <option value="Ba침os de Transportistas">Ba침os de Transportistas</option>
                        <option value="Bodega de Limpieza">Bodega de Limpieza</option>
                        <option value="Camerinos Contratistas">Camerinos Contratistas</option>
                        <option value="Camerinos Permanentes">Camerinos Permanentes</option>
                        <option value="Chiminike">Chiminike</option>
                        <option value="Club de Argos">Club de Argos</option>
                        <option value="Despacho">Despacho</option>
                        <option value="Enfermer칤a">Enfermer칤a</option>
                        <option value="Equipo M칩vil">Equipo M칩vil</option>
                        <option value="Expedici칩n">Expedici칩n</option>
                        <option value="Laboratorio de Calidad">Laboratorio de Calidad</option>
                        <option value="Laboratorio de Concreto">Laboratorio de Concreto</option>
                        <option value="Machaqueo A">Machaqueo A</option>
                        <option value="Posta Principal">Posta Principal</option>
                        <option value="Sala de Control">Sala de Control</option>
                        <option value="Sala de Maternidad">Sala de Maternidad</option>
                        <option value="Sal칩n Vial">Sal칩n Vial</option>
                        <option value="Taller El칠ctrico">Taller El칠ctrico</option>
                    </select>
                </div>
            </div>

            <!-- P치gina 2: Calificaci칩n de Oficinas -->
            <div id="page2" class="hidden">
                <div class="question-container">
                    <label for="calificarOficinas">쮻eseas calificar las Oficinas?</label>
                    <select id="calificarOficinas">
                        <option value="">Selecciona una opci칩n</option>
                        <option value="S칤">S칤</option>
                        <option value="No">No</option>
                    </select>
                </div>

                <div id="oficinaAdministracion" class="question-container" style="display: none;">
                    <label for="oficina">Oficina de Administraci칩n:</label>
                    <input type="text" id="oficina" placeholder="Especifica la oficina" />
                </div>

                <div id="questionsSectionOficinas" style="display: none;">
                    <!-- Preguntas generadas din치micamente para oficinas -->
                </div>
            </div>


            <!-- P치gina 3: Calificaci칩n de Pasillos -->
            <div id="page3" class="hidden">
                <div class="question-container">
                    <label for="calificarPasillos">쮻eseas calificar los Pasillos?</label>
                    <select id="calificarPasillos">
                        <option value="">Selecciona una opci칩n</option>
                        <option value="S칤">S칤</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div id="questionsSectionPasillos" style="display: none;">
                    <!-- Preguntas generadas din치micamente para pasillos -->
                </div>
            </div>

            <!-- P치gina 4: Calificaci칩n de Food Court / 츼rea de Comida -->
            <div id="page4" class="hidden">
                <div class="question-container">
                    <label for="calificarFood">쮻eseas calificar el Food Court / 츼rea de Comida?</label>
                    <select id="calificarFood">
                        <option value="">Selecciona una opci칩n</option>
                        <option value="S칤">S칤</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div id="questionsSectionFood" style="display: none;">
                    <!-- Preguntas generadas din치micamente para Food Court / 츼rea de Comida -->
                </div>
            </div>

            <!-- P치gina 5: Calificaci칩n de Ba침os -->
            <div id="page5" class="hidden">
                <div class="question-container">
                    <label for="calificarBano">쮻eseas calificar los Ba침os?</label>
                    <select id="calificarBano">
                        <option value="">Selecciona una opci칩n</option>
                        <option value="S칤">S칤</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div id="questionsSectionBano" style="display: none;">
                    <!-- Preguntas generadas din치micamente para Ba침os -->
                </div>
            </div>

            <!-- P치gina 6: Calificaci칩n de Alrededores -->
            <div id="page6" class="hidden">
                <div class="question-container">
                    <label for="calificarAlrededor">쮻eseas calificar los Alrededores?</label>
                    <select id="calificarAlrededor">
                        <option value="">Selecciona una opci칩n</option>
                        <option value="S칤">S칤</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div id="questionsSectionAlrededor" style="display: none;">
                    <!-- Preguntas generadas din치micamente para Alrededores -->
                </div>
            </div>

            <!-- P치gina 7: Calificaci칩n de Buenas Pr치cticas -->
            <div id="page7" class="hidden">
                <div class="question-container">
                    <label for="calificarPractica">쮻eseas calificar las Buenas Pr치cticas?</label>
                    <select id="calificarPractica">
                        <option value="">Selecciona una opci칩n</option>
                        <option value="S칤">S칤</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div id="questionsSectionPractica" style="display: none;">
                    <!-- Preguntas generadas din치micamente para las buenas pr치cticas -->
                </div>
            </div>

            <!-- P치gina 8: Comentarios -->
            <div id="page8" class="hidden">
                <div class="question-container">
                    <label for="comentarios">쯈u칠 medidas se tomaron en caso de una no conformidad?</label>
                    <textarea id="comentarios" rows="10" cols="50" placeholder="Escribe aqu칤 tus comentarios..."></textarea>
                </div>
            </div>

            <!-- P치gina 9: Subir im치genes y Descargar PDF -->
            <div id="page9" class="hidden">
                <div class="question-container">
                    <label for="adjunto1">Evidencia:</label>
                    <div class="file-upload" id="drag-area1" onclick="document.getElementById('adjunto1').click()">
                        <input type="file" id="adjunto1" name="adjunto1" accept="image/*" multiple>
                        <span class="file-upload-text">Haz clic o arrastra im치genes para adjuntarlas</span>
                    </div>
                    <div id="preview1" class="image-preview"></div>
                </div>
            </div>

<div class="botones-container">
                <button type="button" id="back">Regresar</button>
                <button type="button" id="next">Siguiente</button>
                <button type="button" id="enviarBtn" disabled onclick="confirmarEnvio()">Enviar</button>
</div>

            <!-- Contenedor para bloquear la pantalla -->
            <div id="overlay" style="display: none;">
                <div id="loadingMessage">
                    <p>Procesando...游봄</p>
                </div>
            </div>

        </div>
    </div>


</body>


<script>


<!-- Contenedor de Volver-->


// Funci칩n para volver al inicio
function goBack() {
    window.history.back();
}


<!-- Contenedor de Volver-->


<!-- Contenedor de Carga-->

// Prellenar fecha y hora al cargar la p치gina
window.onload = prellenarFechaHora;


<!-- Contenedor de Carga-->


<!-- Contenedor para Precargar Fecha-->

// Prellenar fecha y hora
function prellenarFechaHora() {
    let today = new Date();
    let year = today.getFullYear();
    let month = String(today.getMonth() + 1).padStart(2, "0");
    let day = String(today.getDate()).padStart(2, "0");
    document.getElementById("fecha").value = `${year}-${month}-${day}`;
}

<!-- Contenedor para Precargar Fecha-->


<!-- Contenedor para Datos Adjuntos -->

// Objetos para almacenar las im치genes seleccionadas por vista previa
const selectedFiles = {
    preview1: [],
};

function handleFileInput(event, previewId) {
    const files = event.target.files;
    const previewContainer = document.getElementById(previewId);

    Array.from(files).forEach((file) => {
        const reader = new FileReader();
        reader.onload = function (e) {
            const div = document.createElement("div");
            div.classList.add("image-preview-item");
            div.innerHTML = `
	                    <img src="${e.target.result}" alt="Preview">
	                    <div class="delete-icon" onclick="deleteImage('${previewId}', ${selectedFiles[previewId].length})">칑</div>
	                `;
            previewContainer.appendChild(div);

            // Almacena el archivo en la lista correspondiente
            selectedFiles[previewId].push(file);

            // Validar campos despu칠s de agregar una imagen
            validatePage(9);

        };
        reader.readAsDataURL(file);
    });

    // Resetea el input para permitir seleccionar los mismos archivos nuevamente si es necesario
    event.target.value = "";
}

function deleteImage(previewId, index) {
    const previewContainer = document.getElementById(previewId);

    // Elimina la imagen de la vista previa
    previewContainer.removeChild(previewContainer.children[index]);

    // Elimina el archivo correspondiente del arreglo
    selectedFiles[previewId].splice(index, 1);
    validatePage(9);

    // Actualiza los 칤ndices de las im치genes restantes en la vista previa
    Array.from(previewContainer.children).forEach((child, newIndex) => {
        const deleteIcon = child.querySelector(".delete-icon");
        deleteIcon.setAttribute(
            "onclick",
            `deleteImage('${previewId}', ${newIndex})`
        );
    });
}

// Eventos para manejar las entradas de archivos
document
    .getElementById("adjunto1")
    .addEventListener("change", (e) => handleFileInput(e, "preview1"));

// Funciones para manejar arrastre de archivos
const dragAreas = ["drag-area1"];
dragAreas.forEach((area) => {
    const dragArea = document.getElementById(area);
    dragArea.addEventListener("dragover", (event) => {
        event.preventDefault();
        event.stopPropagation();
        dragArea.style.backgroundColor = "#e0f7ff"; // Resaltar el 치rea
    });

    dragArea.addEventListener("dragleave", (event) => {
        event.preventDefault();
        event.stopPropagation();
        dragArea.style.backgroundColor = "#f0f8ff"; // Restaurar color de fondo
    });

    dragArea.addEventListener("drop", (event) => {
        event.preventDefault();
        event.stopPropagation();
        const files = event.dataTransfer.files;
        const previewId = area.replace("drag-area", "preview");
        handleFileInput({ target: { files } }, previewId);
    });
});

// Definir la funci칩n compressImage en el 치mbito global
function compressImage(file, quality) {
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = (event) => {
            const img = new Image();
            img.onload = () => {
                const canvas = document.createElement("canvas");
                const ctx = canvas.getContext("2d");

                // Redimensionar imagen
                const maxWidth = 600;
                const scale = maxWidth / img.width;
                canvas.width = maxWidth;
                canvas.height = img.height * scale;

                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                const dataUrl = canvas.toDataURL("image/jpeg", quality);
                resolve(dataUrl);
            };
            img.src = event.target.result;
        };
        reader.onerror = reject;
        reader.readAsDataURL(file);
    });
}


<!-- Contenedor para Datos Adjuntos -->


<!-- Contenedor de Paginaci칩n-->

// Obtener referencias a los botones y p치ginas
const backButton = document.getElementById("back");
const nextButton = document.getElementById("next");
const enviarBtn = document.getElementById("enviarBtn");
const pages = document.querySelectorAll(".container > .form-container > div");
let currentPage = 1; // Comenzar desde la p치gina 1

// Mostrar la p치gina actual
showPage(currentPage);
document.getElementById('adjunto1').addEventListener('change', (e) => handleFileInput(e, 'preview1'));

// Funci칩n para validar si todos los campos de la p치gina actual est치n completos
// Funci칩n para validar si todos los campos de la p치gina actual est치n completos
function validatePage(pageIndex) {
    const currentPageElement = document.getElementById(`page${pageIndex}`);
    const inputs = currentPageElement.querySelectorAll(
        "input, select, textarea"
    );
    let allFieldsValid = true;

    // Validaci칩n espec칤fica para la p치gina 1 (Fecha y 츼rea)
    if (pageIndex === 1) {
        const fecha = document.getElementById("fecha").value;
        const area = document.getElementById("area").value;

        if (fecha.trim() === "" || area === "Selecciona una opci칩n") {
            allFieldsValid = false;
        }
        return allFieldsValid;
    }

    // Validaci칩n para la p치gina 2 (Oficinas)
    if (pageIndex === 2) {
        const calificarOficinas = document.getElementById("calificarOficinas")
            .value;
        const area = document.getElementById("area").value;
        const oficinaAdministracionDiv = document.getElementById(
            "oficinaAdministracion"
        );

        // Mostrar u ocultar el campo "Oficina de Administraci칩n" seg칰n el 치rea y la respuesta
        if (area === "Administraci칩n" && calificarOficinas === "S칤") {
            oficinaAdministracionDiv.style.display = "block"; // Mostrar el campo
        } else {
            oficinaAdministracionDiv.style.display = "none"; // Ocultar el campo
        }

        // Si la respuesta es "No" o est치 vac칤a, no se revisan las preguntas din치micas
        if (calificarOficinas === "No" || calificarOficinas === "") {
            return true; // Permite avanzar sin revisar preguntas din치micas
        }

        // Si la respuesta es "S칤", se revisan las preguntas din치micas
        if (calificarOficinas === "S칤") {
            const preguntasDinamicas = currentPageElement.querySelectorAll(
                ".question-container select"
            );
            preguntasDinamicas.forEach((select) => {
                if (select.value === "") {
                    allFieldsValid = false;
                }
            });

            // Si el 치rea es "Administraci칩n", se revisa el campo adicional
            if (area === "Administraci칩n") {
                const oficina = document.getElementById("oficina").value;
                if (oficina.trim() === "") {
                    allFieldsValid = false;
                }
            }
        }
        return allFieldsValid;
    }

    // Validaci칩n para las p치ginas 3 a 7 (Preguntas principales y din치micas)
    if (pageIndex >= 3 && pageIndex <= 7) {
        const preguntaPrincipal = currentPageElement.querySelector("select")
            .value;

        // Si la respuesta es "No" o est치 vac칤a, no se revisan las preguntas din치micas
        if (preguntaPrincipal === "No" || preguntaPrincipal === "") {
            return true; // Permite avanzar sin revisar preguntas din치micas
        }

        // Si la respuesta es "S칤", se revisan las preguntas din치micas
        if (preguntaPrincipal === "S칤") {
            const preguntasDinamicas = currentPageElement.querySelectorAll(
                ".question-container select"
            );
            preguntasDinamicas.forEach((select) => {
                if (select.value === "") {
                    allFieldsValid = false;
                }
            });
        }
        return allFieldsValid;
    }

    // Validaci칩n para la p치gina 9 (Subir im치genes)
    if (pageIndex === 9) {
        const hayImagenAdjunta = document.getElementById('preview1').children.length > 0;

        if (hayImagenAdjunta) {
            enviarBtn.disabled = false; // Habilitar el bot칩n de enviar
        } else {
            enviarBtn.disabled = true; // Deshabilitar el bot칩n de enviar
        }

        return hayImagenAdjunta; // Retornar true si hay im치genes, false si no
    }

    return allFieldsValid;
}

// Funci칩n para habilitar o deshabilitar el bot칩n "Siguiente"
function toggleNextButton() {
    const nextButton = document.getElementById("next");
    const isValid = validatePage(currentPage);

    if (isValid) {
        nextButton.disabled = false;
    } else {
        nextButton.disabled = true;
    }
}

// Escuchar cambios en los campos de la p치gina actual
function addInputListeners(pageIndex) {
    const currentPageElement = document.getElementById(`page${pageIndex}`);
    const inputs = currentPageElement.querySelectorAll(
        "input, select, textarea"
    );

    inputs.forEach((input) => {
        input.addEventListener("change", toggleNextButton);
        if (input.tagName === "INPUT" || input.tagName === "TEXTAREA") {
            input.addEventListener("input", toggleNextButton); // Para campos de texto
        }
    });
}

// Mostrar la p치gina actual y agregar listeners
function showPage(pageIndex) {
    const totalPages = 9; // N칰mero total de p치ginas

    // Ocultar todas las p치ginas
    pages.forEach((page) => {
        page.classList.add("hidden");
        page.classList.remove("visible");
    });

    // Mostrar la p치gina actual
    const currentPageElement = document.getElementById(`page${pageIndex}`);
    if (currentPageElement) {
        currentPageElement.classList.remove("hidden");
        currentPageElement.classList.add("visible");
    }

    // Control de botones
    backButton.style.display = pageIndex === 1 ? "none" : "inline-block";
    nextButton.style.display =
        pageIndex === totalPages ? "none" : "inline-block";
    enviarBtn.style.display =
        pageIndex === totalPages ? "inline-block" : "none";

    // Deshabilitar el bot칩n "Siguiente" inicialmente
    nextButton.disabled = true;

    // Agregar listeners a los campos de la p치gina actual
    addInputListeners(pageIndex);

    // Validar la p치gina actual para habilitar o deshabilitar el bot칩n "Siguiente"
    toggleNextButton();
}

// Eventos para los botones de navegaci칩n
nextButton.addEventListener("click", () => {
    if (currentPage < 9) {
        currentPage++;
        showPage(currentPage);
    }
});

backButton.addEventListener("click", () => {
    if (currentPage > 1) {
        currentPage--;
        showPage(currentPage);
    }
});

<!-- Contenedor de Paginaci칩n-->
	

<!-- Contenedor de Paginaci칩n - Mostrar / Ocultar Preguntas-->


function toggleQuestions(selectId, sectionId, specificSectionId = null) {
    const selectElement = document.getElementById(selectId);
    const sectionElement = document.getElementById(sectionId);
    const specificSectionElement = specificSectionId
        ? document.getElementById(specificSectionId)
        : null;

    selectElement.addEventListener("change", function () {
        if (this.value === "S칤") {
            sectionElement.style.display = "block";
            if (specificSectionElement) {
                specificSectionElement.style.display = "block";
            }
        } else {
            sectionElement.style.display = "none";
            if (specificSectionElement) {
                specificSectionElement.style.display = "none";
            }
        }
    });
}

// Aplicar la funci칩n a cada secci칩n
toggleQuestions(
    "calificarOficinas",
    "questionsSectionOficinas",
    "oficinaAdministracion"
);
toggleQuestions("calificarPasillos", "questionsSectionPasillos");
toggleQuestions("calificarFood", "questionsSectionFood");
toggleQuestions("calificarBano", "questionsSectionBano");
toggleQuestions("calificarAlrededor", "questionsSectionAlrededor");
toggleQuestions("calificarPractica", "questionsSectionPractica");


<!-- Contenedor de Paginaci칩n - Mostrar / Ocultar Preguntas-->


<!-- Contenedor de Generaci칩n de Preguntas-->


const questionsOficinas = [
    {
        id: "question1",
        text: "쯉e observa presencia de telas de ara침a?",
        options: ["S칤", "No"],
    },
    {
        id: "question2",
        text:
            "쯃os escritorios, mesas, estantes, archiveros y dem치s superficies de trabajo est치n limpios?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question3",
        text:
            "쯃os dispositivos electr칩nicos compartidos (tel칠fonos, teclados, computadoras y otros) est치n limpios?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question4",
        text:
            "쯃as superficies de contacto frecuente (manijas, interruptores, pasamanos) est치n limpias y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question5",
        text: "쮼l oasis se encuentra limpio y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question6",
        text: "쮼l microondas se encuentra limpio y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question7",
        text: "쯃as cafeteras se encuentra limpias y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question8",
        text: "쯃as refrigeradoras se encuentra limpias y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question9",
        text: "쯃as ventanas y dem치s vidrios se encuentran limpios?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question10",
        text: "쯃as puertas se encuentran limpias y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question11",
        text: "쯃as sillas est치n limpias (Sin polvo y patas limpias)?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question12",
        text: "쮼l piso est치 limpio y sin manchas visibles?",
        options: ["S칤", "No"],
    },
    {
        id: "question13",
        text:
            "쯃os basureros se encuentran limpios y con su respectiva bolsa de basura?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question14",
        text:
            "쯃os dispensadores (papel toalla, jab칩n, gel) est치n limpios, abastecidos y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question15",
        text: "쮼l 치rea se encuentra aromatizada?",
        options: ["S칤", "No"],
    },
];


const questionsPasillos = [
    {
        id: "question16",
        text: "쯉e observa presencia de telas de ara침a?",
        options: ["S칤", "No"],
    },
    {
        id: "question17",
        text:
            "쯃as superficies de contacto frecuente (manijas, interruptores, pasamanos) est치n limpias y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question18",
        text: "쯃as ventanas y dem치s vidrios se encuentran limpios?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question19",
        text: "쯃os extintores se encuentran limpios?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question20",
        text: "쮼l piso est치 limpio y sin manchas visibles?",
        options: ["S칤", "No"],
    },
    {
        id: "question21",
        text:
            "쯃os basureros se encuentran limpios y con su respectiva bolsa de basura?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question22",
        text:
            "쯃os dispensadores (papel toalla, jab칩n, gel) est치n limpios, abastecidos y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question23",
        text: "쯃as cafeteras se encuentra limpias y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question24",
        text: "쮼l 치rea se encuentra aromatizada?",
        options: ["S칤", "No"],
    },
];


const questionsFood = [
    {
        id: "question25",
        text: "쯉e observa presencia de telas de ara침a?",
        options: ["S칤", "No"],
    },
    {
        id: "question26",
        text:
            "쯃as superficies de contacto frecuente (manijas, interruptores, pasamanos) est치n limpias y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question27",
        text: "쮼l oasis se encuentra limpio y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question28",
        text: "쮼l microondas se encuentra limpio y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question29",
        text: "쯃as cafeteras se encuentra limpias y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question30",
        text: "쯃as refrigeradoras se encuentra limpias y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question31",
        text: "쯃as ventanas y dem치s vidrios se encuentran limpios?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question32",
        text: "쯃as sillas est치n limpias (Sin polvo y patas limpias)?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question33",
        text: "쯃as mesas est치n limpias?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question34",
        text: "쮼l piso est치 limpio y sin manchas visible?",
        options: ["S칤", "No"],
    },
    {
        id: "question35",
        text:
            "쯃os basureros se encuentran limpios y con su respectiva bolsa de basura?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question36",
        text:
            "쯃os dispensadores (papel toalla, jab칩n, gel) est치n limpios, abastecidos y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question37",
        text: "쮼l 치rea se encuentra aromatizada?",
        options: ["S칤", "No"],
    },
];


const questionsBano = [
    {
        id: "question38",
        text: "쮼l 치rea se encuentra aromatizada?",
        options: ["S칤", "No"],
    },
    {
        id: "question39",
        text: "쯉e observa presencia de telas de ara침a?",
        options: ["S칤", "No"],
    },
    {
        id: "question40",
        text: "쯃os pisos est치n limpios?",
        options: ["S칤", "No"],
    },
    {
        id: "question41",
        text: "쯃as ventanas y dem치s vidrios se encuentran limpios?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question42",
        text: "쯃as paredes se encuentran limpias y sin manchas visibles?",
        options: ["S칤", "No"],
    },
    {
        id: "question43",
        text: "쯃as puertas se encuentran limpias y sin manchas visibles?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question44",
        text:
            "쯃as divisiones (puertas / acr칤licos, etc) se encuentran limpias y sin manchas visibles?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question45",
        text:
            "쯃os lavamanos est치n limpios, libres de sarro y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question46",
        text: "쯃os espejos est치n limpios y sin presencia de manchas?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question47",
        text:
            "쯃os sanitarios est치n limpios, libres de sarro y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question48",
        text:
            "쯃os urinarios est치n limpios, libres de sarro y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question49",
        text: "쯃as duchas est치n limpias, libres de sarro y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question50",
        text:
            "쯃os basureros se encuentran limpios y con su respectiva bolsa de basura?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question51",
        text:
            "쯃os dispensadores (papel toalla, jab칩n, gel) est치n limpios, abastecidos y en funcionamiento?",
        options: ["S칤", "No", "N/A"],
    },
];


const questionsAlrededor = [
    {
        id: "question52",
        text:
            "쯃as 치reas exteriores, incluyendo aceras, entradas se encuentran limpias?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question53",
        text: "쯃as pilas / piletas se encuentran limpias y en buen estado?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question54",
        text: "쮿ay presencia de basura, hojas u otros desechos en el suelo?",
        options: ["S칤", "No"],
    },
    {
        id: "question55",
        text: "쯃os contenedores de basura est치n saturados de basura?",
        options: ["S칤", "No", "N/A"],
    },
    {
        id: "question56",
        text: "쯃as paredes se encuentran limpias y sin manchas visibles?",
        options: ["S칤", "No"],
    },
    {
        id: "question57",
        text: "쯃as ventanas y dem치s vidrios se encuentran limpios?",
        options: ["S칤", "No", "N/A"],
    },
];


const questionsPractica = [
    {
        id: "question58",
        text:
            "쮼l personal est치 cumpliendo con la ejecuci칩n y el llenado de los reportes diarios en 치reas y ba침os?",
        options: ["S칤", "No"],
    },
    {
        id: "question59",
        text:
            "쮼l personal asignado est치 haciendo buen uso del equipo de protecci칩n?",
        options: ["S칤", "No"],
    },
    {
        id: "question60",
        text:
            '쮼l personal asignado est치 utilizando correctamente el r칩tulo de "Limpieza en progreso" durante sus actividades?',
        options: ["S칤", "No"],
    },
    {
        id: "question61",
        text:
            "쯉e respeta la codificaci칩n de colores en los pa침os de microfibra para evitar la contaminaci칩n cruzada?",
        options: ["S칤", "No"],
    },
    {
        id: "question62",
        text:
            "쯉e respeta la codificaci칩n de colores en las mechas de trapeador para evitar la contaminaci칩n cruzada?",
        options: ["S칤", "No"],
    },
    {
        id: "question63",
        text:
            "쮼l personal asignado est치 utilizando adecuadamente las herramientas de limpieza durante su manipulaci칩n?",
        options: ["S칤", "No"],
    },
    {
        id: "question64",
        text:
            "쮼l personal asignado est치 utilizando los productos qu칤micos de forma segura?",
        options: ["S칤", "No"],
    },
    {
        id: "question65",
        text:
            "쯉e almacena correctamente el equipo de limpieza, ordenado y sin restos de suciedad?",
        options: ["S칤", "No"],
    },
    {
        id: "question66",
        text:
            "쮿ay alguna herramienta que muestre signos de deterioro o desgaste que puedan afectar su funcionamiento?",
        options: ["S칤", "No"],
    },
    {
        id: "question67",
        text:
            "쯊odas las herramientas cuentan con un etiquetado claro y legible que facilite su identificaci칩n?",
        options: ["S칤", "No"],
    },
];


const questionsSectionOficinas = document.getElementById("questionsSectionOficinas");
const questionsSectionPasillos = document.getElementById("questionsSectionPasillos");
const questionsSectionFood = document.getElementById("questionsSectionFood");
const questionsSectionBano = document.getElementById("questionsSectionBano");
const questionsSectionAlrededor = document.getElementById("questionsSectionAlrededor");
const questionsSectionPractica = document.getElementById("questionsSectionPractica");

// Generar preguntas din치micamente para oficinas
questionsOficinas.forEach((q) => {
    const questionContainer = document.createElement("div");
    questionContainer.classList.add("question-container");
    const label = document.createElement("label");
    label.setAttribute("for", q.id);
    label.textContent = q.text;
    questionContainer.appendChild(label);

    const select = document.createElement("select");
    select.id = q.id;
    select.name = q.id;
    select.innerHTML =
        '<option value="">Selecciona una opci칩n</option>' +
        q.options
            .map((option) => `<option value="${option}">${option}</option>`)
            .join("");
    questionContainer.appendChild(select);

    questionsSectionOficinas.appendChild(questionContainer);
});

// Generar preguntas din치micamente para pasillos
questionsPasillos.forEach((q) => {
    const questionContainer = document.createElement("div");
    questionContainer.classList.add("question-container");
    const label = document.createElement("label");
    label.setAttribute("for", q.id);
    label.textContent = q.text;
    questionContainer.appendChild(label);

    const select = document.createElement("select");
    select.id = q.id;
    select.name = q.id;
    select.innerHTML =
        '<option value="">Selecciona una opci칩n</option>' +
        q.options
            .map((option) => `<option value="${option}">${option}</option>`)
            .join("");
    questionContainer.appendChild(select);

    questionsSectionPasillos.appendChild(questionContainer);
});

// Generar preguntas din치micamente para Food Court / 츼rea de Comida
questionsFood.forEach((q) => {
    const questionContainer = document.createElement("div");
    questionContainer.classList.add("question-container");
    const label = document.createElement("label");
    label.setAttribute("for", q.id);
    label.textContent = q.text;
    questionContainer.appendChild(label);

    const select = document.createElement("select");
    select.id = q.id;
    select.name = q.id;
    select.innerHTML =
        '<option value="">Selecciona una opci칩n</option>' +
        q.options
            .map((option) => `<option value="${option}">${option}</option>`)
            .join("");
    questionContainer.appendChild(select);

    questionsSectionFood.appendChild(questionContainer);
});

// Generar preguntas din치micamente para Ba침os
questionsBano.forEach((q) => {
    const questionContainer = document.createElement("div");
    questionContainer.classList.add("question-container");
    const label = document.createElement("label");
    label.setAttribute("for", q.id);
    label.textContent = q.text;
    questionContainer.appendChild(label);

    const select = document.createElement("select");
    select.id = q.id;
    select.name = q.id;
    select.innerHTML =
        '<option value="">Selecciona una opci칩n</option>' +
        q.options
            .map((option) => `<option value="${option}">${option}</option>`)
            .join("");
    questionContainer.appendChild(select);

    questionsSectionBano.appendChild(questionContainer);
});

// Generar preguntas din치micamente para Alrededores
questionsAlrededor.forEach((q) => {
    const questionContainer = document.createElement("div");
    questionContainer.classList.add("question-container");
    const label = document.createElement("label");
    label.setAttribute("for", q.id);
    label.textContent = q.text;
    questionContainer.appendChild(label);

    const select = document.createElement("select");
    select.id = q.id;
    select.name = q.id;
    select.innerHTML =
        '<option value="">Selecciona una opci칩n</option>' +
        q.options
            .map((option) => `<option value="${option}">${option}</option>`)
            .join("");
    questionContainer.appendChild(select);

    questionsSectionAlrededor.appendChild(questionContainer);
});

// Generar preguntas din치micamente para las buenas pr치cticas
questionsPractica.forEach((q) => {
    const questionContainer = document.createElement("div");
    questionContainer.classList.add("question-container");
    const label = document.createElement("label");
    label.setAttribute("for", q.id);
    label.textContent = q.text;
    questionContainer.appendChild(label);

    const select = document.createElement("select");
    select.id = q.id;
    select.name = q.id;
    select.innerHTML =
        '<option value="">Selecciona una opci칩n</option>' +
        q.options
            .map((option) => `<option value="${option}">${option}</option>`)
            .join("");
    questionContainer.appendChild(select);

    questionsSectionPractica.appendChild(questionContainer);
});


<!-- Contenedor de Generaci칩n de Preguntas-->


<!-- Contenedor para Confirmar Env칤o-->


function confirmarEnvio() {
    Swal.fire({
        text: "쮼st치s seguro de continuar? 游뱂",
        icon: "question",
        showCancelButton: true,
        confirmButtonText: "S칤 游삐",
        cancelButtonText: "No 游땳",
        customClass: {
            popup: "swal-popup", // Clase para el modal
            confirmButton: "swal-button", // Clase para el bot칩n de confirmaci칩n
            cancelButton: "swal-button-cancel", // Clase para el bot칩n de cancelaci칩n
            actions: "swal-actions", // Clase para el contenedor de los botones
        },
    }).then((result) => {
        if (result.isConfirmed) {
            // Mostrar el overlay de "Procesando..."
            document.getElementById("overlay").style.display = "flex";
            enviarDatos();
        }
    });
}


<!-- Contenedor para Confirmar Env칤o-->


<!-- Contenedor para EnviarDatos-->


async function enviarDatos() {
    try {
        // Obtener valores del formulario
        const fecha = document.getElementById("fecha").value;
        const comentarios = document.getElementById("comentarios").value;

        // Crear el PDF
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF({ format: "letter" });
        const pageWidth = pdf.internal.pageSize.getWidth();
        const pageHeight = pdf.internal.pageSize.getHeight();

        // Definir la funci칩n imageToBase64 tal como la compartiste
        function imageToBase64(imgPath, callback) {
            const reader = new FileReader();
            reader.onload = function (e) {
                callback(e.target.result);
            };
            fetch(imgPath)
                .then((response) => response.blob())
                .then((blob) => reader.readAsDataURL(blob))
                .catch((error) => console.error("Error al convertir a base64:", error));
        }

        // Crear una promesa para usar await con tu funci칩n imageToBase64
        function getLogoBase64(imgPath) {
            return new Promise((resolve, reject) => {
                imageToBase64(imgPath, function (base64) {
                    resolve(base64);
                });
            });
        }

        // Convertir la imagen del logo a base64 usando tu funci칩n
        const logoBase64 = await getLogoBase64("Im치genes/Icono.png");

        // Funci칩n para agregar texto con manejo de nuevas p치ginas
        function addTextWithPageBreak(text, x, y, options = {}) {
            const lineHeight = 10; // Altura de l칤nea
            const marginBottom = 10; // Margen inferior
            let currentY = y;

            // Dividir el texto en l칤neas
            const lines = pdf.splitTextToSize(
                text,
                options.maxWidth || pageWidth - x - 10
            );

            // Agregar cada l칤nea al PDF
            lines.forEach((line) => {
                if (currentY + lineHeight > pageHeight - marginBottom) {
                    pdf.addPage(); // Agregar nueva p치gina
                    currentY = 20; // Reiniciar la posici칩n Y en la nueva p치gina
                }
                pdf.text(line, x, currentY);
                currentY += lineHeight; // Mover a la siguiente l칤nea
            });

            return currentY; // Devolver la posici칩n Y final
        }

        // Portada
        pdf.setFont("times", "bold");
        pdf.setFontSize(16);

        // Agregar el logo (usando la cadena base64 generada autom치ticamente)
        pdf.addImage(logoBase64, "PNG", 10, 10, 50, 50); // Ajusta las coordenadas y el tama침o seg칰n sea necesario

        // T칤tulo del reporte
        pdf.setFontSize(24);
        pdf.text("Reporte de Supervisi칩n", pageWidth / 2, 30, { align: "center" });

        // Informaci칩n del proyecto
        pdf.setFontSize(16);
        pdf.text("Proyecto: Cementera Argos", pageWidth / 2, 50, { align: "center" });
        pdf.text("Nombre del Supervisor: Jeancarlo Zelaya", pageWidth / 2, 65, { align: "center" });
        pdf.text("Correo: jromero@grupomacdel.com", pageWidth / 2, 80, { align: "center" });
        pdf.text("Actividad: Supervisi칩n de 츼reas (Espec칤fico)", pageWidth / 2, 95, { align: "center" });

        // L칤nea horizontal
        pdf.line(10, 105, pageWidth - 10, 105);

        // Fecha y firma
        pdf.text(`Fecha: ${fecha}`, 10, 115);
        pdf.text(
            "츼rea a Supervisar: " + document.getElementById("area").value,
            10,
            130
        );

        // Si oficina no est치 vac칤a, agregarla
        let oficinaValue = document.getElementById("oficina").value;
        if (oficinaValue !== "") {
            pdf.text("Oficina: " + oficinaValue, 10, 145);
            yPosition = 160;
        } else {
            yPosition = 145;
        }

        // Comentarios (filtrados de emoticones)
        if (comentarios && comentarios.trim() !== "") {
            const comentariosFiltrada = comentarios.replace(
                /[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}\u{1F900}-\u{1F9FF}\u{1FA70}-\u{1FAFF}\u{200D}\u{FE0F}]/gu,
                ""
            );
            if (comentariosFiltrada.trim() !== "") {
                pdf.setFont("times", "bold");
                yPosition = addTextWithPageBreak(`Comentarios:`, 10, yPosition);
                pdf.setFont("times", "normal");
                yPosition = addTextWithPageBreak(
                    comentariosFiltrada,
                    15,
                    yPosition + 5,
                    { maxWidth: 190 }
                );
            }
        }


        // Recopilar respuestas de las p치ginas 2 a 7
        const respuestas = recopilarRespuestas();

        // Agregar respuestas al PDF
        if (Object.keys(respuestas).length > 0) {
            for (const [seccion, preguntas] of Object.entries(respuestas)) {
                // Agregar nueva p치gina para cada secci칩n
                pdf.addPage();
                pdf.setFont("times", "bold");
                pdf.setFontSize(16);
                pdf.text(`${seccion}:`, 10, 20);
                pdf.line(10, 23, 190, 23);

                // Crear datos para la tabla
                const tableData = preguntas.map((r) => [
                    r.pregunta, // Columna de preguntas
                    r.si, // Columna de S칤
                    r.no, // Columna de No
                    r.na, // Columna de N/A
                ]);

                // Configurar la tabla
                pdf.autoTable({
                    startY: 30, // Posici칩n Y inicial de la tabla
                    head: [["Pregunta", "S칤", "No", "N/A"]], // Encabezados de la tabla
                    body: tableData, // Datos de la tabla
                    theme: "grid", // Estilo de la tabla (grid, striped, plain)
                    headStyles: {
                        fillColor: [41, 128, 185], // Color de fondo del encabezado
                        textColor: [255, 255, 255], // Color del texto del encabezado
                        fontStyle: "bold", // Negrita para el encabezado
                        halign: "center", // Centrar texto horizontalmente
                        valign: "middle", // Centrar texto verticalmente
                    },
                    bodyStyles: {
                        textColor: [0, 0, 0], // Color del texto del cuerpo
                        fontStyle: "normal", // Estilo normal para el cuerpo
                        valign: "middle", // Centrar texto verticalmente
                    },
                    columnStyles: {
                        0: { cellWidth: "auto", fontStyle: "bold" }, // Pregunta en negrita
                        1: {
                            cellWidth: 20,
                            halign: "center",
                            valign: "middle",
                        }, // S칤 (ancho fijo y centrado)
                        2: {
                            cellWidth: 20,
                            halign: "center",
                            valign: "middle",
                        }, // No (ancho fijo y centrado)
                        3: {
                            cellWidth: 20,
                            halign: "center",
                            valign: "middle",
                        }, // N/A (ancho fijo y centrado)
                    },
                    margin: { top: 30 }, // Margen superior
                });
            }
        }

        // Manejar datos adjuntos (im치genes)
        for (let i = 1; i <= 1; i++) {
            const input = document.getElementById(`adjunto${i}`);
            if (selectedFiles[`preview${i}`].length > 0) {
                const files = selectedFiles[`preview${i}`];
                let imgCount = 0;

                // Comenzar una nueva p치gina al principio de cada conjunto de im치genes
                pdf.addPage();
                pdf.setFont("times", "bold"); // Cambiar a Times y negrita

                // Establecer el t칤tulo seg칰n el grupo de im치genes (Antes, Durante, Despu칠s)
                let sectionTitle = "";
                if (i === 1) {
                    sectionTitle = "Evidencia:";
                }

                // Agregar el t칤tulo correspondiente
                pdf.text(sectionTitle, 10, 15);

                const imgWidth = 60; // Ancho de imagen ajustado
                const imgHeight = 40; // Alto de imagen ajustado
                const marginX = 15; // Margen izquierdo
                const marginY = 20; // Margen superior
                const spacingX = 65; // Espacio entre columnas
                const spacingY = 45; // Espacio entre filas
                const pageHeight = pdf.internal.pageSize.height; // Altura de la p치gina

                // Iterar a trav칠s de las im치genes
                for (let j = 0; j < files.length; j++) {
                    const file = files[j];
                    const imgData = await compressImage(file, 0.5); // Comprimir imagen

                    // Calcular la posici칩n X y Y para la imagen
                    const x = (imgCount % 3) * spacingX + marginX; // Posici칩n X
                    const y = Math.floor(imgCount / 3) * spacingY + marginY; // Posici칩n Y

                    // Verificar si la imagen se sale de los m치rgenes de la p치gina
                    if (y + imgHeight > pageHeight - marginY) {
                        // A침adir nueva p치gina si se excede el espacio
                        pdf.addPage();
                        pdf.text(`Continuaci칩n datos adjuntos #${i}:`, 10, 10);
                        imgCount = 0; // Reiniciar el conteo para la nueva p치gina
                    }

                    // A침adir la imagen a la p치gina
                    pdf.addImage(imgData, "JPEG", x, y, imgWidth, imgHeight);
                    imgCount++;

                    // Si imgCount llega a 15, reiniciar
                    if (imgCount === 15) {
                        imgCount = 0; // Reiniciar el conteo de im치genes para la siguiente p치gina

                        // Solo a침adir una nueva p치gina si hay m치s de 15 im치genes
                        if (
                            selectedFiles[`preview${i}`].length % 15 !== 0 &&
                            selectedFiles[`preview${i}`].length > 0
                        ) {
                            pdf.addPage(); // A침adir nueva p치gina

                            // Establecer el t칤tulo de la nueva p치gina seg칰n la secci칩n
                            let sectionTitle = "";
                            if (i === 1) {
                                sectionTitle = "Evidencia:";
                            }

                            // A침adir un encabezado a la nueva p치gina
                            pdf.text(sectionTitle, 10, 15);
                        }
                    }
                }
            }
        }

        let area = document.getElementById('area').value;
        let oficina = document.getElementById('oficina').value;

        // Crear un nombre para el archivo basado en la fecha y el 치rea
        let nombreArchivo = `${fecha} - Reporte de Supervisi칩n - ${area}`;

        // Si el 치rea es "Administraci칩n" y hay una oficina especificada, agregarla al nombre
        if (area === "Administraci칩n" && oficina) {
            nombreArchivo += ` - ${oficina}`;
        }

        // Agregar la extensi칩n .pdf al nombre del archivo
        nombreArchivo += ".pdf";

        // Convertir el PDF generado a base64
        const pdfBase64 = pdf.output("datauristring").split(",")[1];

        // Enviar el archivo al script de Google Apps
        const response = await fetch(
            "https://script.google.com/macros/s/AKfycbyhOCwHZ_SVtrxwNwVJ59MHg6KtB7TEKd5sdFf-KphdRWXi8HUyMfIOamvnUkHFQ1_9/exec",
            {
                method: "POST",
                body: new URLSearchParams({
                    pdfFile: pdfBase64,
                    fileName: nombreArchivo,
                }),
            }
        );

        const result = await response.text();
        console.log("Archivo guardado con ID:", result);

        // Ocultar el overlay de "Procesando..."
        document.getElementById("overlay").style.display = "none";

        // Mostrar mensaje de 칠xito con SweetAlert2
        Swal.fire({
            text: "춰Env칤o exitoso! 游봅游꿀",
            icon: "success",
            showCancelButton: false, // No mostrar el bot칩n de cancelar
            confirmButtonText: "Aceptar",
            customClass: {
                content: "swal-content",
                confirmButton: "swal-button",
                popup: "swal-popup",
            },
            footer:
                '<button id="descargar-pdf" class="swal-button">Descargar PDF</button>', // Bot칩n personalizado
        }).then((result) => {
            if (result.isConfirmed) {
                // Si el usuario hace clic en "Aceptar", recargar la p치gina
            }
        });

        // Agregar un evento al bot칩n personalizado para descargar el PDF
        document.addEventListener("click", (event) => {
            if (event.target && event.target.id === "descargar-pdf") {
                pdf.save(nombreArchivo); // Descargar el PDF
            }
        });
    } catch (error) {
        console.error("Error al enviar los datos:", error);

        // Ocultar el overlay de "Procesando..."
        document.getElementById("overlay").style.display = "none";

        // Mostrar mensaje de error con SweetAlert2
        Swal.fire({
            text:
                "Hubo un problema al enviar los datos. Intenta nuevamente. 游땩",
            icon: "error",
            confirmButtonText: "Aceptar",
            customClass: {
                content: "swal-content",
                confirmButton: "swal-button",
                popup: "swal-popup",
            },
        });
    }
}


function recopilarRespuestas() {
    const respuestas = {};

    // Recopilar respuestas de la p치gina 2 (Oficinas)
    if (document.getElementById("calificarOficinas").value === "S칤") {
        respuestas["Oficinas"] = questionsOficinas.map((q) => {
            const respuesta = document.getElementById(q.id).value;
            return {
                pregunta: q.text,
                si: respuesta === "S칤" ? "X" : "",
                no: respuesta === "No" ? "X" : "",
                na: respuesta === "N/A" ? "X" : "",
            };
        });
    }

    // Recopilar respuestas de la p치gina 3 (Pasillos)
    if (document.getElementById("calificarPasillos").value === "S칤") {
        respuestas["Pasillos"] = questionsPasillos.map((q) => {
            const respuesta = document.getElementById(q.id).value;
            return {
                pregunta: q.text,
                si: respuesta === "S칤" ? "X" : "",
                no: respuesta === "No" ? "X" : "",
                na: respuesta === "N/A" ? "X" : "",
            };
        });
    }

    // Recopilar respuestas de la p치gina 4 (Food Court / 츼rea de Comida)
    if (document.getElementById("calificarFood").value === "S칤") {
        respuestas["Food Court / 츼rea de Comida"] = questionsFood.map((q) => {
            const respuesta = document.getElementById(q.id).value;
            return {
                pregunta: q.text,
                si: respuesta === "S칤" ? "X" : "",
                no: respuesta === "No" ? "X" : "",
                na: respuesta === "N/A" ? "X" : "",
            };
        });
    }

    // Recopilar respuestas de la p치gina 5 (Ba침os)
    if (document.getElementById("calificarBano").value === "S칤") {
        respuestas["Ba침os"] = questionsBano.map((q) => {
            const respuesta = document.getElementById(q.id).value;
            return {
                pregunta: q.text,
                si: respuesta === "S칤" ? "X" : "",
                no: respuesta === "No" ? "X" : "",
                na: respuesta === "N/A" ? "X" : "",
            };
        });
    }

    // Recopilar respuestas de la p치gina 6 (Alrededores)
    if (document.getElementById("calificarAlrededor").value === "S칤") {
        respuestas["Alrededores"] = questionsAlrededor.map((q) => {
            const respuesta = document.getElementById(q.id).value;
            return {
                pregunta: q.text,
                si: respuesta === "S칤" ? "X" : "",
                no: respuesta === "No" ? "X" : "",
                na: respuesta === "N/A" ? "X" : "",
            };
        });
    }

    // Recopilar respuestas de la p치gina 7 (Buenas Pr치cticas)
    if (document.getElementById("calificarPractica").value === "S칤") {
        respuestas["Buenas Pr치cticas"] = questionsPractica.map((q) => {
            const respuesta = document.getElementById(q.id).value;
            return {
                pregunta: q.text,
                si: respuesta === "S칤" ? "X" : "",
                no: respuesta === "No" ? "X" : "",
                na: respuesta === "N/A" ? "X" : "",
            };
        });
    }

    return respuestas;
}


<!-- Contenedor para EnviarDatos-->
	
	
</script>
</body>
</html>
