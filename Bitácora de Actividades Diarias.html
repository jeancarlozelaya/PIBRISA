<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Bitácora de Actividades Diarias</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        /* Evita el desplazamiento horizontal y asegura que el body ocupe el 100% del viewport */
        body, html {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            width: 100%;
            max-width: 100%;
            overflow-x: hidden; /* Oculta el desplazamiento horizontal */
        }

        /* Header */
        .header {
            background-color: #007BFF;
            color: white;
            text-align: center;
            padding: 15px;
            width: 100%;
            font-size: 1.5em;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            box-sizing: border-box; /* Asegura que el padding no exceda el ancho */
        }

        /* Contenedor del formulario */
        .container {
            background: #ffffff;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
            text-align: center;
            margin: 40px auto;
            grid-row: 2;
            height: auto;
            box-sizing: border-box; /* Incluye el padding en el ancho total */
        }

        h1 {
            text-align: center;
            color: #333;
            margin: 0 0 20px 0; /* Ajusta el margen inferior */
        }

        label {
            display: block;
            margin-top: 10px;
            font-weight: bold;
        }

        input[type="date"],
        input[type="time"],
        input[type="text"],
        textarea,
        select,
        #oficina,
        button {
            width: 100%;
            margin-top: 5px;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box; /* Incluye el padding en el ancho total */
        }

        button {
            background-color: #007bff;
            color: #fff;
            border: none;
            cursor: pointer;
            padding: 12px 0;
        }

        button:hover {
            background-color: #0056b3;
        }

        /* Estilo para el botón "Volver al Inicio" */
        .back-button {
            display: inline-block;
            padding: 10px 20px;
            background-color: #007BFF;
            color: white;
            border-radius: 5px;
            text-decoration: none;
            text-align: center;
            font-size: 1em;
            transition: background-color 0.3s, transform 0.3s;
            position: fixed;
            top: 80px;
            left: 0px;
            z-index: 1001;
            box-sizing: border-box; /* Incluye el padding en el ancho total */
        }

        .back-button:hover {
            background-color: #0056b3;
            transform: scale(1.05);
        }

        /* Estilo para los contenedores de preguntas */
        .question-container {
            margin-bottom: 20px;
            text-align: left;
            padding: 10px;
            border: 2px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
            transition: border-color 0.3s;
            box-sizing: border-box; /* Incluye el padding en el ancho total */
        }

        .question-container:hover {
            border-color: #007BFF;
        }

        .question-container input[type="date"],
        .question-container input[type="time"],
        .question-container input[type="text"],
        .question-container textarea,
        .question-container select {
            padding: 10px;
            border: 2px solid #ccc;
            border-radius: 5px;
            width: 100%;
            font-size: 16px;
            background-color: #f9f9f9;
            color: #333;
            transition: border-color 0.3s;
            box-sizing: border-box; /* Incluye el padding en el ancho total */
            margin-top: 5px;
        }

        .question-container input[type="date"]:focus,
        .question-container input[type="time"]:focus,
        .question-container input[type="text"]:focus,
        .question-container textarea:focus,
        .question-container select:focus {
            border-color: #007BFF;
            outline: none;
        }

        /* Estilo del overlay (pantalla bloqueada) */
        #overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        #loadingMessage {
            color: white;
            font-size: 24px;
            font-family: 'Times New Roman', Times, serif;
            text-align: center;
            padding: 20px;
        }

        /* Estilo para Mensajes */
        .swal-actions {
            display: flex; /* Coloca los botones en una fila */
            justify-content: center; /* Centra los botones horizontalmente */
            gap: 10px; /* Espacio entre los botones */
            width: 80%; /* Limita el ancho del contenedor al 80% del modal */
            margin: 0 auto; /* Centra el contenedor horizontalmente */
            flex-wrap: nowrap; /* Evita que los botones se apilen en dos filas */
        }

        /* Estilo personalizado para el contenido del mensaje */
        .swal-content {
            font-size: 0.9em;  /* Reduce el tamaño del texto */
            line-height: 1.4;  /* Ajusta el espaciado entre líneas */
        }

        .swal2-html-container {
            margin-bottom: 15px;
        }

        /* Estilo personalizado para ambos botones */
        .swal-button,
        .swal-button-cancel {
            flex: 1; /* Hace que ambos botones ocupen el mismo espacio */
            min-width: 120px; /* Ancho mínimo para ambos botones */
            padding: 10px 20px; /* Espaciado interno */
            font-size: 14px; /* Tamaño de fuente */
            text-align: center; /* Centra el texto dentro del botón */
            border: none; /* Elimina el borde predeterminado */
            border-radius: 4px; /* Bordes redondeados */
            color: white; /* Texto en blanco */
            transition: background-color 0.3s ease; /* Transición suave para el hover */
        }



    /* Estilo personalizado para el popup/modal */
    .swal-popup {
        width: 300px;  /* Ajusta el ancho máximo del modal */
        max-width: 90%;  /* Permite que el modal sea flexible en pantallas pequeñas */
    }


        /* Opcional: colores específicos para cada botón */
        .swal-button {
            background-color: #28a745;  /* Verde para el botón de "Sí" */
            color: white;  /* Texto en blanco */
            border: none;
            border-radius: 4px;
        }

        .swal-button-cancel {
            background-color: #FF6347 ;  /* Rojo para el botón de "No" */
            color: white;  /* Texto oscuro */
            border: none;
            border-radius: 4px;
        }

        .swal2-actions {
            display: flex !important;  /* Asegura que los botones estén en una fila */
            justify-content: center;   /* Centra los botones horizontalmente */
            gap: 10px;                 /* Agrega espacio entre los botones */
            flex-wrap: nowrap;         /* Evita que los botones se apilen en dos filas */
        }

        /* Eliminar el borde negro del ícono personalizado */
        .swal2-icon.swal2-icon-show {
            background-color: transparent !important; /* Fondo transparente */
        }

        .no-border-icon {
            border: none !important; /* Elimina el borde circular */
            background-color: transparent !important; /* Fondo transparente */
        }

        /* Estilo para Botones, Habilitar/Deshabilitar */
        #enviarBtn {
            background-color: #007bff; /* Color azul */
            color: white;
            border: none;
            cursor: pointer;
            padding: 12px 0;
            font-size: 16px;
            border-radius: 5px;
            transition: background-color 0.3s ease, opacity 0.3s ease;
        }

        /* Estilo para el botón de enviar cuando está deshabilitado */
        #enviarBtn:disabled {
            background-color: #ccc; /* Color gris */
            color: #666666; /* Texto gris oscuro */
            cursor: not-allowed; /* Cambia el cursor a "no permitido" */
            opacity: 0.7; /* Reduce la opacidad para dar un aspecto deshabilitado */
        }

        /* Efecto hover solo cuando el botón está habilitado */
        #enviarBtn:not(:disabled):hover {
            background-color: #0056b3; /* Color azul más oscuro al pasar el mouse */
        }

        /* Estilo para Botones, Misma Linea */
        .botones-container {
            display: flex; /* Hace que los botones estén en la misma línea */
            justify-content: space-between; /* Espacio entre los botones */
            gap: 10px; /* Espacio entre los botones */
            margin-top: 20px; /* Margen superior para separar del contenido anterior */
        }

        /* Estilo para los botones dentro del contenedor */
        .botones-container button {
            flex: 1; /* Hace que los botones ocupen el espacio disponible */
            margin: 0; /* Elimina el margen predeterminado */
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f4f4f4;
        }

/* Centrar los encabezados de la tabla */
#tablaActividades th {
    text-align: center;
}

/* Centrar las celdas de las columnas Frecuencia y Realizada */
#tablaActividades td:nth-child(2),
#tablaActividades td:nth-child(3) {
    text-align: center;
}

/* Centrar los checkboxes en la columna Realizada */
#tablaActividades td:nth-child(3) input[type="checkbox"] {
    margin: 0 auto;
    display: block;
}


/* Color para filas con frecuencia Diario */
.fila-diario {
    background-color: #A6D5FA; /* Azul pastel más bonito */
}

/* Color para filas con frecuencia Semanal */
.fila-semanal {
    background-color: #FFC0CB; /* Lila pastel más bonito */
}

/* Estilo para la simbología */
.simbologia {
    margin-bottom: 10px;
    font-size: 14px;
    display: flex;
    gap: 10px;
}

.simbologia div {
    padding: 5px 10px;
    border-radius: 5px;
}

/* Estilo para la simbología */
.simbologia .diario {
    background-color: #A6D5FA; /* Azul pastel */
}

.simbologia .semanal {
    background-color: #FFC0CB; /* Lila pastel */
}




/* Ocultar la columna de Frecuencia */
#tablaActividades th:nth-child(2),
#tablaActividades td:nth-child(2) {
    display: none;
}


/* Estilo para hacer los checkboxes más grandes */
#tablaActividades input[type="checkbox"] {
    width: 20px;       /* Ancho del checkbox */
    height: 20px;      /* Alto del checkbox */
    transform: scale(1.5); /* Escala el checkbox para hacerlo más grande */
    margin: 0 auto;    /* Centra el checkbox en la celda */
    display: block;    /* Asegura que el margen auto funcione */
    cursor: pointer;   /* Cambia el cursor al pasar sobre el checkbox */
}

/* Opcional: estilo para cuando el checkbox está marcado */
#tablaActividades input[type="checkbox"]:checked {
    background-color: #007BFF; /* Color de fondo cuando está marcado */
}

    </style>
</head>
<body>
    <div class="header">
        Pisos Brillantes
    </div>
    <a href="javascript:void(0);" class="back-button" onclick="goBack()">Volver al Inicio</a>
    <div class="container">
        <h1>Bitácora de Actividades Diarias</h1>
        <div class="form-container">
            <form id="bitacoraForm">
                <div class="question-container">
                    <label for="fecha">Fecha:</label>
                    <input type="date" id="fecha" name="fecha" required>
                </div>

                <div class="question-container">
                    <label for="tipo">Tipo de Actividad:</label>
                    <select id="tipo" name="tipo" required onchange="mostrarCampos()">
                        <option value="">Selecciona una opción</option>
                        <option value="Área">Área</option>
                        <option value="Baño">Baño</option>
                    </select>
                </div>

                <div class="question-container" id="areaContainer" style="display: none;">
                    <label for="area">Área:</label>
                    <select id="area" name="area">
                        <option value="">Selecciona una opción</option>
                        <option value="Administración">Administración</option>
                        <option value="Almacén General">Almacén General</option>
                        <option value="Bodega de Limpieza">Bodega de Limpieza</option>
                        <option value="Chiminike">Chiminike</option>
                        <option value="Despacho">Despacho</option>
                        <option value="Enfermería">Enfermería</option>
                        <option value="Equipo Móvil">Equipo Móvil</option>
                        <option value="Expedición">Expedición</option>
                        <option value="Laboratorio de Calidad">Laboratorio de Calidad</option>
                        <option value="Laboratorio de Concreto">Laboratorio de Concreto</option>
                        <option value="Machaqueo A">Machaqueo A</option>
                        <option value="Posta Principal">Posta Principal</option>
                        <option value="Sala de Control">Sala de Control</option>
                        <option value="Sala de Maternidad">Sala de Maternidad</option>
                        <option value="Salón Vial">Salón Vial</option>
                        <option value="Taller Eléctrico">Taller Eléctrico</option>
                    </select>
                </div>

<div class="question-container" id="oficinaContainer" style="display: none;">
    <label for="oficina">Oficina:</label>
    <select id="oficina" name="oficina">
        <option value="">Selecciona una opción</option>
        <option value="Biblioteca">Biblioteca</option>
        <option value="Compras">Compras</option>
        <option value="Contabilidad">Contabilidad</option>
        <option value="Coordinación de Ejecución Eléctrica">Coordinación de Ejecución Eléctrica</option>
        <option value="Coordinación de Ejecución Mecánica">Coordinación de Ejecución Mecánica</option>
        <option value="CRO">CRO</option>
        <option value="Educa">Educa</option>
        <option value="Ejecutores de Mantenimiento">Ejecutores de Mantenimiento</option>
        <option value="Gerencia">Gerencia</option>
        <option value="Gerencia de Calidad">Gerencia de Calidad</option>
        <option value="Gerencia de Mantenimiento">Gerencia de Mantenimiento</option>
        <option value="Gerencia de Materias Primas">Gerencia de Materias Primas</option>
        <option value="Gerencia de Procesos">Gerencia de Procesos</option>
        <option value="Informática">Informática</option>
        <option value="Inspectores de Mantenimiento">Inspectores de Mantenimiento</option>
        <option value="Materias Primas">Materias Primas</option>
        <option value="Oficina 121">Oficina 121</option>
        <option value="Oficina de Supervisión">Oficina de Supervisión</option>
        <option value="Oficina de Visitas">Oficina de Visitas</option>
        <option value="Procesos">Procesos</option>
        <option value="Producción">Producción</option>
        <option value="Profesionales Eléctricos">Profesionales Eléctricos</option>
        <option value="Proyectos">Proyectos</option>
        <option value="Recursos Humanos">Recursos Humanos</option>
        <option value="RRHH">RRHH</option>
        <option value="Sala de Reuniones">Sala de Reuniones</option>
        <option value="Sala de Reuniones de Mantenimiento">Sala de Reuniones de Mantenimiento</option>
        <option value="SISO">SISO</option>
        <option value="Sub Gerencia">Sub Gerencia</option>
    </select>
</div>

                <div class="question-container" id="bañoContainer" style="display: none;">
                    <label for="baño">Baños de:</label>
                    <select id="baño" name="baño">
                        <option value="">Selecciona una opción</option>
                        <option value="Admin - Gerencia">Admin - Gerencia</option>
                        <option value="Admin - Hombres">Admin - Hombres</option>
                        <option value="Admin - Mujeres">Admin - Mujeres</option>
                        <option value="Admin - Sala de Reuniones">Admin - Sala de Reuniones</option>
                        <option value="Almacen General">Almacen General</option>
                        <option value="Camerinos Contratistas">Camerinos Contratistas</option>
                        <option value="Camerinos Permanentes">Camerinos Permanentes</option>
                        <option value="Despacho">Despacho</option>
                        <option value="Enfermería">Enfermería</option>
                        <option value="Expedición">Expedición</option>
                        <option value="Laboratorio de Calidad">Laboratorio de Calidad</option>
                        <option value="Laboratorio de Concreto">Laboratorio de Concreto</option>
                        <option value="Machaqueo A">Machaqueo A</option>
                        <option value="Posta Guardias">Posta Guardias</option>
                        <option value="Posta Recepción">Posta Recepción</option>
                        <option value="Sala de Control">Sala de Control</option>
                        <option value="Salón Vial">Salón Vial</option>
                        <option value="Taller Electrico">Taller Electrico</option>
                        <option value="Transportistas">Transportistas</option>
                    </select>
                </div>

                <div class="simbologia">
                    <div class="diario">Diario</div>
                    <div class="semanal">Semanal</div>
                </div>

                <table id="tablaActividades">
                    <thead>
                        <tr>
                            <th>Actividad</th>
                            <th>Frecuencia</th>
                            <th>Realizada</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Las actividades se generarán automáticamente aquí -->
                    </tbody>
                </table>

                <button type="button" id="enviarBtn" disabled onclick="confirmarEnvio()">Enviar</button>
            </form>

            <!-- Contenedor para bloquear la pantalla -->
            <div id="overlay" style="display: none;">
                <div id="loadingMessage">
                    <p>Procesando...🥱</p>
                </div>
            </div>
        </div>
    </div>

<script>
    // Función para volver al inicio
    function goBack() {
        window.location.href = "Bitácoras.html";
    }

    // Precargar la fecha actual
    function prellenarFechaHora() {
        let today = new Date();
        let year = today.getFullYear();
        let month = String(today.getMonth() + 1).padStart(2, "0");
        let day = String(today.getDate()).padStart(2, "0");
        document.getElementById("fecha").value = `${year}-${month}-${day}`;
    }

    // Llamar a la función para precargar la fecha al cargar la página
    prellenarFechaHora();

    // Arreglo COMPLETO de actividades para Áreas (sin omitir ninguna)
    const actividadesArea = [
        { descripcion: "Sacudir o aspirar el polvo de los muebles y las estanterías en las áreas designadas.", frecuencia: "Diario" },
        { descripcion: "Limpiar y desinfectar todas las superficies de trabajo, incluyendo escritorios, mesas, estantes, archiveros y mostradores.", frecuencia: "Diario" },
        { descripcion: "Limpiar y desinfectar los teléfonos, teclados, mouse y otros dispositivos electrónicos compartidos.", frecuencia: "Diario" },
        { descripcion: "Limpiar y desinfectar todas las superficies de contacto frecuente, como manijas de puertas, interruptores de luz y pasamanos.", frecuencia: "Diario" },
        { descripcion: "Limpieza y desinfeccion de los oasis. Limpiar toda la superficie exterior con un paño desinfectante o toallitas adecuadas para eliminar gérmenes y mantener un entorno de trabajo saludable.", frecuencia: "Diario" },
        { descripcion: "Limpieza y desinfeccion de los microondas. Limpiar la superficie exterior e interior, con un paño desinfectante o toallitas adecuadas para eliminar gérmenes y mantener un entorno de trabajo saludable.", frecuencia: "Diario" },
        { descripcion: "Limpieza y lavado de las percoladoras, desmontar las piezas removibles y lavarlas con agua y jabón, asegurándose de enjuagarlas bien. Limpia la superficie exterior con un paño desinfectante para mantener la higiene.", frecuencia: "Diario" },
        { descripcion: "Limpieza y desinfección de las refrigeradoras, limpiar tanto por dentro como por fuera, incluyendo estantes y cajones, usando un paño desinfectante para mantener un entorno seguro para los alimentos.", frecuencia: "Diario" },
        { descripcion: "Barrer o mopear el suelo en toda el área designada para eliminar el polvo y la suciedad.", frecuencia: "Diario" },
        { descripcion: "Recolectar la basura de todos los basureros, asegurandose de reemplazar las bolsas de basura por nuevas.", frecuencia: "Diario" },
        { descripcion: "Reponer los suministros de papel higiénico, toallas de papel, jabón y otros suministros necesarios.", frecuencia: "Diario" },
        { descripcion: "Trapear el suelo en toda el área designada utilizando desinfectante, asegurando una limpieza más profunda y desinfección.", frecuencia: "Diario" },
        { descripcion: "Aplicar un aromatizante en el área designada después de haber terminado la limpieza para mantener un ambiente fresco y agradable.", frecuencia: "Diario" },
        { descripcion: "Limpiar las telas de araña y el polvo acumulado en las esquinas y techos utilizando un escobillón para alcanzar las áreas altas de manera efectiva.", frecuencia: "Semanal" },
        { descripcion: "Realizar un lavado profundo del oasis, de esta manera garantizar la calidad del agua que se dispensa y mantener el funcionamiento óptimo del equipo.", frecuencia: "Semanal" },
        { descripcion: "Eliminar las partículas de polvo en los diferentes vidrios con un paño de microfibra color café. Aplicar limpiador de vidrio con un paño de microfibra azul para obtener un acabado brillante y sin rayas.", frecuencia: "Semanal" },
        { descripcion: "Limpiar y aplicar abrillantador en las patas de las sillas usando un paño de microfibra color cafe para eliminar la suciedad y el polvo acumulado, y de esta manera dejarlas con un acabado brillante.", frecuencia: "Semanal" },
        { descripcion: "Lavar las piletas de alrededores de las áreas.", frecuencia: "Semanal" },
        { descripcion: "Lavar las papeleras de basura de las oficinas. Utilizar detergente y agua para lavar tanto el interior como el exterior de las papeleras, asegurándose de eliminar los gérmenes y olores no deseados.", frecuencia: "Semanal" }
    ];

    // Arreglo COMPLETO de actividades para Baños (sin omitir ninguna)
    const actividadesBaño = [
        { descripcion: "Recolectar la basura de todos los basureros, asegurándose de reemplazar las bolsas de basura por nuevas.", frecuencia: "Diario" },
        { descripcion: "Barrer o mopear el suelo en toda el área designada para eliminar el polvo y la suciedad.", frecuencia: "Diario" },
        { descripcion: "Limpieza y desinfección de los urinarios presentes.", frecuencia: "Diario" },
        { descripcion: "Limpieza y desinfección de los sanitarios presentes.", frecuencia: "Diario" },
        { descripcion: "Limpieza y desinfección de las duchas presentes.", frecuencia: "Diario" },
        { descripcion: "Limpieza y desinfección de los lavamanos presentes.", frecuencia: "Diario" },
        { descripcion: "Revisar que no haya daños o problemas de funcionamiento en los baños, y en caso que aplique reportar al supervisor.", frecuencia: "Diario" },
        { descripcion: "Limpieza y desinfección de todas las superficies de contacto frecuente, como manijas de puertas, interruptores de luz y pasamanos.", frecuencia: "Diario" },
        { descripcion: "Limpieza y desinfección de los recubrimientos como azulejos aplicando una solución concentrada de cloro al 0.2% y secar con una toalla de microfibra color amarillo.", frecuencia: "Diario" },
        { descripcion: "Aplicar el limpiador y pulidor de acero inoxidable, con una toalla de microfibra color café en las superficies de acero inoxidable presentes en el área.", frecuencia: "Diario" },
        { descripcion: "Aplicar limpiador de vidrio en los espejos con un paño de microfibra color azul para obtener un acabado brillante y sin rayas.", frecuencia: "Diario" },
        { descripcion: "Reponer los suministros de papel higiénico, toallas de papel, jabón y otros suministros necesarios.", frecuencia: "Diario" },
        { descripcion: "Revisar el estado de funcionamiento de los diferentes dispensadores que estén presentes, y en caso de daño reportar al supervisor.", frecuencia: "Diario" },
        { descripcion: "Trapear el suelo en toda el área designada utilizando desinfectante, asegurando una limpieza más profunda y desinfección.", frecuencia: "Diario" },
        { descripcion: "Aplicar un aromatizante en el área designada después de haber terminado la limpieza para mantener un ambiente fresco y agradable.", frecuencia: "Diario" },
        { descripcion: "Reemplazar la pastilla PDC con alambre si ha perdido su aroma o está muy reducida en tamaño.", frecuencia: "Semanal" },
        { descripcion: "Reemplazar el tapete antisalpicadura del urinario si está deteriorado o desprende mal olor.", frecuencia: "Semanal" },
        { descripcion: "Limpiar las telas de araña y el polvo acumulado en las esquinas y techos utilizando un escobillón para alcanzar las áreas altas de manera efectiva.", frecuencia: "Semanal" },
        { descripcion: "Lavar las papeleras de basura. Utilizar detergente y agua para lavar tanto el interior como el exterior, asegurándose de eliminar los gérmenes y olores no deseados.", frecuencia: "Semanal" }
    ];

    // Función para mostrar u ocultar campos según el tipo de actividad
    function mostrarCampos() {
        const tipo = document.getElementById("tipo").value;
        const areaContainer = document.getElementById("areaContainer");
        const bañoContainer = document.getElementById("bañoContainer");
        const oficinaContainer = document.getElementById("oficinaContainer");

        // Resetear visibilidad
        areaContainer.style.display = "none";
        bañoContainer.style.display = "none";
        oficinaContainer.style.display = "none";

        if (tipo === "Área") {
            areaContainer.style.display = "block";
            generarTablaActividades(actividadesArea);
            
            // Verificar si el área seleccionada es "Administración"
            const area = document.getElementById("area").value;
            if (area === "Administración") {
                oficinaContainer.style.display = "block";
            }
        } else if (tipo === "Baño") {
            bañoContainer.style.display = "block";
            generarTablaActividades(actividadesBaño);
        }
    }

    // Función para generar las filas de la tabla
    function generarTablaActividades(actividades) {
        const tbody = document.querySelector("#tablaActividades tbody");
        tbody.innerHTML = ""; // Limpiar la tabla antes de generar nuevas filas

        actividades.forEach((actividad) => {
            const row = document.createElement("tr");

            // Agregar clase según la frecuencia
            if (actividad.frecuencia === "Diario") {
                row.classList.add("fila-diario");
            } else if (actividad.frecuencia === "Semanal") {
                row.classList.add("fila-semanal");
            }

            row.innerHTML = `
                <td>${actividad.descripcion}</td>
                <td>${actividad.frecuencia}</td>
                <td><input type="checkbox" name="actividad" value="${actividad.descripcion}"></td>
            `;
            tbody.appendChild(row);
        });
    }

    // Función para verificar si todos los campos están completos
    function verificarCampos() {
        const tipo = document.getElementById("tipo").value;
        const area = document.getElementById("area").value;
        const baño = document.getElementById("baño").value;
        const oficina = document.getElementById("oficina").value;
        const actividades = document.querySelectorAll('input[name="actividad"]:checked').length;

        // Verificar el tipo de actividad
        if (tipo === "") {
            return false; // No se ha seleccionado un tipo
        }

        // Verificar si es Área o Baño
        if (tipo === "Área") {
            if (area === "") return false; // No se ha seleccionado un área
            if (area === "Administración" && oficina === "") return false; // Para administración, se requiere oficina
        } else if (tipo === "Baño" && baño === "") {
            return false; // No se ha seleccionado un baño
        }

        // Verificar que al menos una actividad esté seleccionada
        if (actividades === 0) {
            return false; // No se ha seleccionado ninguna actividad
        }

        // Si todo está correcto, habilitar el botón
        return true;
    }

    // Función para habilitar o deshabilitar el botón de Enviar
    function actualizarBotonEnviar() {
        const enviarBtn = document.getElementById("enviarBtn");
        enviarBtn.disabled = !verificarCampos();
    }

    // Escuchar cambios en los campos
    document.getElementById("tipo").addEventListener("change", function () {
        mostrarCampos(); // Mostrar u ocultar campos según el tipo
        actualizarBotonEnviar(); // Actualizar el estado del botón
    });

    document.getElementById("area").addEventListener("change", function() {
        const area = this.value;
        const oficinaContainer = document.getElementById("oficinaContainer");
        
        if (area === "Administración") {
            oficinaContainer.style.display = "block";
        } else {
            oficinaContainer.style.display = "none";
            document.getElementById("oficina").value = ""; // Resetear el valor
        }
        
        actualizarBotonEnviar(); // Actualizar el estado del botón
    });

    document.getElementById("baño").addEventListener("change", actualizarBotonEnviar);
    document.getElementById("oficina").addEventListener("change", actualizarBotonEnviar);

    // Escuchar cambios en las actividades
    document.querySelector("#tablaActividades tbody").addEventListener("change", function (e) {
        if (e.target.type === "checkbox") {
            actualizarBotonEnviar(); // Actualizar el estado del botón
        }
    });

    // Función para confirmar el envío
    function confirmarEnvio() {
        Swal.fire({
            text: "¿Estás seguro de continuar? 🤔",
            icon: "question",
            showCancelButton: true,
            confirmButtonText: "Sí 🫡",
            cancelButtonText: "No 😬",
            customClass: {
                popup: "swal-popup", // Clase para el modal
                confirmButton: "swal-button", // Clase para el botón de confirmación
                cancelButton: "swal-button-cancel", // Clase para el botón de cancelación
                actions: "swal-actions", // Clase para el contenedor de los botones
            },
        }).then((result) => {
            if (result.isConfirmed) {
                // Mostrar el overlay de "Procesando..."
                document.getElementById("overlay").style.display = "flex";

                const fecha = $('#fecha').val();
                const tipo = $('#tipo').val();
                const area = $('#area').val();
                const baño = $('#baño').val();
                const oficina = $('#oficina').val();
                const actividades = [];

                // Recolectar las actividades marcadas
                $('input[name="actividad"]:checked').each(function() {
                    actividades.push($(this).val());
                });

                // Verificar que se hayan seleccionado actividades
                if (actividades.length === 0) {
                    Swal.fire({
                        text: 'Debes seleccionar al menos una actividad.',
                        icon: 'warning',
                        confirmButtonText: 'Aceptar'
                    });
                    return;
                }

                enviarDatos(fecha, tipo, area, baño, oficina, actividades);
            }
        });
    }

    // Función para enviar datos
    function enviarDatos(fecha, tipo, area, baño, oficina, actividades) {
        let url = "";

        // Verificar el tipo de actividad
        if (tipo === "Área") {
            // Asignar la URL según el área seleccionada
            switch (area) {
case "Administración":
    // Ahora depende de la oficina seleccionada
    switch (oficina) {
        case "Biblioteca":
            url = "https://script.google.com/macros/s/AKfycbyazbNcKwMKiFLXB4s28cjD5VixVf1DWnpRr3SIRUA4DYuMvazJH9gptkH17PFVKpzD/exec"; // Reemplazar con URL real
            break;
        case "Compras":
            url = "https://script.google.com/macros/s/AKfycbz0oUpJvwoEkCmM0ablvRyaaGFp-A063EIVIHJusfGTn44gCLihoLOVibwHrINuSYyaHg/exec";
            break;
        case "Contabilidad":
            url = "https://script.google.com/macros/s/AKfycbzFqLtFY3mwjYqr9QWMm6KYwek17qGse1R9xwZYVMj2Xg7Fq6v6B9pFGrvStvNKWfD2/exec";
            break;
        case "Coordinación de Ejecución Eléctrica":
            url = "https://script.google.com/macros/s/AKfycbxm1IK48yKxcdFPQSxOfghMa_hrX9ngm3TdGnZHL5WYbgJ0DXr0lamqd0Uhk6iUbjBacg/exec";
            break;
        case "Coordinación de Ejecución Mecánica":
            url = "https://script.google.com/macros/s/AKfycbx0Mj-t231OKbvAIjfbXwMrSdzsA1Kho1sl44nEGNS7-fvGqzUr2whSHIq_Ibe7_gqsdA/exec";
            break;
        case "CRO":
            url = "https://script.google.com/macros/s/AKfycby1teNgt0YWC962CVZDvLXGxaEbhfe4iI0_I01Tsh2st0exJ75VNWQHKX35zD44_ZhJHA/exec";
            break;
        case "Educa":
            url = "https://script.google.com/macros/s/AKfycbwPUrjBwZDE8YOZLv6H6_dYHyZ6DAfr6xOD7I19xxqVC3Xr5OCtUK1_WxzHblfVp1Tu/exec";
            break;
        case "Ejecutores de Mantenimiento":
            url = "https://script.google.com/macros/s/AKfycbzOoXPH675fY29qlb0i0xMW6si3pPO9UAqkgRrJQpUTNghuAfZClMDnhbOwqBnp0H0BjQ/exec";
            break;
        case "Gerencia":
            url = "https://script.google.com/macros/s/AKfycbzWobnEFQwuhEmTTY2z_gmG3C0IX0xL7gY91SvcFFlw6baUECcj7IreMLPqtFFGCdDu3g/exec";
            break;
        case "Gerencia de Calidad":
            url = "https://script.google.com/macros/s/AKfycbxObK-_HENQKjGU4YF-XkbhzlQNyM4fQpdh4nSly_s9ZEEziJ0faZbSBtl6Drp2dtag/exec";
            break;
        case "Gerencia de Mantenimiento":
            url = "https://script.google.com/macros/s/AKfycbziOihYMTW4HyQcBYCLm3GjDysJZr0yAPCzpFRTEtKT0I2NIiOfMm8ZLWK6hrUo0OKV/exec";
            break;
        case "Gerencia de Materias Primas":
            url = "https://script.google.com/macros/s/AKfycbxcU58hLpszm-hMfFRE7_8yyrOmu2W8POWxHdB-TBS9L7Xnr9-o0gd4rDLoKsGK12IR/exec";
            break;
        case "Gerencia de Procesos":
            url = "https://script.google.com/macros/s/AKfycbw6laHNuXen55FLVk4cVsi6jgQe2QkDNBMDBMTUb07h5U50JNfFpGeGclh6L7Nb3z0b5g/exec";
            break;
        case "Informática":
            url = "https://script.google.com/macros/s/AKfycbyp5G5U6qmUJlZLdat2iiMfltTibc2AZwdPHkjL0rAmdm85M3TiqTVjb-Ohp8Oyp3p5VQ/exec";
            break;
        case "Inspectores de Mantenimiento":
            url = "https://script.google.com/macros/s/AKfycbypi9qmn5fpeWd80OC6evCAb8Ozhk0I_fRecAvw0Yqcw8vH8SWACLNug-63CVfqt3y5/exec";
            break;
        case "Materias Primas":
            url = "https://script.google.com/macros/s/AKfycbwVzFLezm8uMEF5v26UC5xD5KidDPsVLJRfe_M0XLNeb3bt1L2aPSNL_-MV00hUdsvY/exec";
            break;
        case "Oficina 121":
            url = "https://script.google.com/macros/s/AKfycbwB0cJlrCR-7xIROq9YbuvWEqr4KdoSaI7RpwpiIcGszb3kE6Py115XX5ctxhs-Hntx/exec";
            break;
        case "Oficina de Supervisión":
            url = "https://script.google.com/macros/s/AKfycbxjiINRGMpQwLgPrHHJJSYgAqNWmW5uxsjGzVLTsa5G3fF-s7GptQ75YPn0LjxXDeaLBA/exec";
            break;
        case "Oficina de Visitas":
            url = "https://script.google.com/macros/s/AKfycbwF_JoweN8OxykvC5VIklgn7QPt0b4ta9D_NNFcLA6LhWjOrCXw6HU8R_yjKG3A2OQICg/exec";
            break;
        case "Procesos":
            url = "https://script.google.com/macros/s/AKfycbwYwG9fH__L--D-zReXfOO9v5NmXiS--w0WeEuYloZRNTEHiy9tlMQv2n23VMNB8bfSKQ/exec";
            break;
        case "Producción":
            url = "https://script.google.com/macros/s/AKfycbykHkizd5-zStpzJjlZudfLfEulFdFVTZpW6GGHsuTcBHmvLe349kcZJ8aTU5o5TpNt/exec";
            break;
        case "Profesionales Eléctricos":
            url = "https://script.google.com/macros/s/AKfycbx9danmeHEoZM9kr4dq2OIXaLreOuzElRLfkJqKE4X4RJ2pz_CV0kqskfl5bda03zT2UQ/exec";
            break;
        case "Proyectos":
            url = "https://script.google.com/macros/s/AKfycbzCqMlV75Y5rGYa4ppd7kylnHT_81PebAew61XEBnuwGL8Rq_8n0PU3r1zNI1rdZLt4/exec";
            break;
        case "RRHH":
            url = "https://script.google.com/macros/s/AKfycbys3_ur-iHqq-V5XjlDj3OK0xm29B6gsOeTmZYnjkjQYC-Puqg6oqqNmsrnUMgIKqShXg/exec";
            break;
        case "Sala de Reuniones":
            url = "https://script.google.com/macros/s/AKfycbyAWhbBorceXlY4TsztFRk9r3akvPBKxYk3kCXTx3NxrQK_fxNudPqfaEFd3ucKDbvSGA/exec";
            break;
        case "Sala de Reuniones de Mantenimiento":
            url = "https://script.google.com/macros/s/AKfycbyMdQnfL9Vlu0zGHEqSmB2YbNeIX5GTX4CfOGmRdaXF5g0Doz_BDpYW0QAYEnKCc1Hm/exec";
            break;
        case "SISO":
            url = "https://script.google.com/macros/s/AKfycbzaEPiaTt6Lvt8rxij1JQ0JRxkC3W5wXd1Dxc2PohyYmGiU3JkAjit1_iIA_VkWlyHx/exec";
            break;
        case "Sub Gerencia":
            url = "https://script.google.com/macros/s/AKfycbzH80oDQkmKv8imztY2dacSG_lxNbz5_eLpJ8OEMmbb8DtsCm2NCbFL6l31ffHUbXKF/exec";
            break;
        default:
            console.error("Oficina no reconocida:", oficina);
            return;
    }
                    break;
                case "Almacén General":
                    url = "https://script.google.com/macros/s/AKfycbx6_eCKR84HNwj1jiwQm_9FDSIIYQhHYIPHnAeiyTwRU7fsa4yzOclqB9HgiurpA6hp/exec";
                    break;
                case "Bodega de Limpieza":
                    url = "https://script.google.com/macros/s/AKfycbx69iYA3XmgOz00WHv6f1Forac1zUCytBFFARRLg4l6rhmZ1j60Q4gVKSDPi3mjHxOHeg/exec";
                    break;
                case "Chiminike":
                    url = "https://script.google.com/macros/s/AKfycbzV9atlrcyNVU0OgHZvA_A-IWYaIs3GOEFZZmvat1orVVaF9yu3rtZDKJNYig5RY6yu/exec";
                    break;
                case "Despacho":
                    url = "https://script.google.com/macros/s/AKfycbyhUyDTjin_odtgWyASfts4rsArtRxmOaOTBHJs4zRzbZCBu1Hh3xUMiDDhPsqhksqhhw/exec";
                    break;
                case "Enfermería":
                    url = "https://script.google.com/macros/s/AKfycbyg5M6lXIhCdvLDYpby1yUoWs22cujKWAeJf0u3INc8f_bJvE7xj1M8cAxFu14gMWjj/exec";
                    break;
                case "Equipo Móvil":
                    url = "https://script.google.com/macros/s/AKfycbxC1cMBeLHG-iOdgCyyu5o76Xw1niCbAaNbw-DXuc7T9wOOq8_bI3PF4cJ16xPftmWx1A/exec";
                    break;
                case "Expedición":
                    url = "https://script.google.com/macros/s/AKfycbwC8utyR7mR7-aQ6G-GaqAOPa16J3Z3A14LtG1rRYOfD8r9Zrt6THYbaHNqYSv-a7zS/exec";
                    break;
                case "Laboratorio de Calidad":
                    url = "https://script.google.com/macros/s/AKfycbwvageEn09g-wxJGSoRMRITx6jAMlUTVBRQf08_90TOUHanUPYkre2EjuBljRONxnJP/exec";
                    break;
                case "Laboratorio de Concreto":
                    url = "https://script.google.com/macros/s/AKfycbz-BpBAuXZ4m2Tvofw46ulW-N-9A4GE6rsDJ4IYqyaw9aHsx4fw7gF3b4v2-LxR8kEg/exec";
                    break;
                case "Machaqueo A":
                    url = "https://script.google.com/macros/s/AKfycbxZjYTHfEaTPNirsOOFGTtWcBL1nIior8hIFd0aXalEcZFUnIPCknTTRJES9ZKHsrnX/exec";
                    break;
                case "Posta Principal":
                    url = "https://script.google.com/macros/s/AKfycbzrgd4y0fzPbfv6WeuH-R1heSj9eAIwTBpWZeP_mcTWNzT0OD6kLEOxgVz3bbKuWS5P/exec";
                    break;
                case "Sala de Control":
                    url = "https://script.google.com/macros/s/AKfycbxYvvzdJEOYlesgDZ2GhDiOCNdnVM_cKL3Qrk4eFXCUKWtbPtEhCAyX3B7aEOUsNPOITQ/exec";
                    break;
                case "Sala de Maternidad":
                    url = "https://script.google.com/macros/s/AKfycby0guTFX5SZH5-AVCKFmnkPDjriiaSVEHhx56GKIQ18s_yzomdYdAsstYT1bc-19KtX/exec";
                    break;
                case "Salón Vial":
                    url = "https://script.google.com/macros/s/AKfycbzFRJ9i4-D-K6dFuuf4l12GXB6IIq2b2z928F8XNV_E3CO3AWZmvs-aS_vzxwLtR6b-/exec";
                    break;
                case "Taller Eléctrico":
                    url = "https://script.google.com/macros/s/AKfycby6cfOOVkRLP2DEp6AMTbYvQr5nUuAWs0_2dl4wadCeStQ5dkrxplV3dZgGppiNlRzZ/exec";
                    break;
                default:
                    console.error("Área no reconocida:", area);
                    return;
            }
        } else if (tipo === "Baño") {
            // Asignar la URL según el baño seleccionado
            switch (baño) {
                case "Admin - Gerencia":
                    url = "https://script.google.com/macros/s/AKfycbzdp8-7o8MBv73trut8S4_0NctjdRsRl349KyNtNMxr6Co7Llsadp-Uv2VmoMN2_x6fyg/exec";
                    break;
                case "Admin - Hombres":
                    url = "https://script.google.com/macros/s/AKfycbx5nzRtHpNtdBCtp-jE1teLKWFDqU_KI-lEygNPeiEDY_GUNZpu9RTgqh9y7Tk5G0id/exec";
                    break;
                case "Admin - Mujeres":
                    url = "https://script.google.com/macros/s/AKfycbzBiWOek8-Aa4yEOKG-WZDvJcVvB39nQsdLXpZwtSAsqsJ-SiZcRYdCFqYUeavez3_D/exec";
                    break;
                case "Admin - Sala de Reuniones":
                    url = "https://script.google.com/macros/s/AKfycbyEB9M6kcs_0NiM2jmJrslUJ4e11K5MutIL1DDshH4bUZJ7HEAa_Cf5bh6ozCbRIx10UA/exec";
                    break;
                case "Almacen General":
                    url = "https://script.google.com/macros/s/AKfycbxGQFphEPeCZQbO7NrX2XLKZ78-o0YAS40cCd3vDzl6ibdqruMdMu3fODDZ4peUsXXTVw/exec";
                    break;
                case "Camerinos Contratistas":
                    url = "https://script.google.com/macros/s/AKfycbwVyZ9o_pz3NXRaoIFKNoIaVs-Bgg4GMR4KTgJWDvfPhK0nPA0pA-GuskerbduBrUpb/exec";
                    break;
                case "Camerinos Permanentes":
                    url = "https://script.google.com/macros/s/AKfycbwG0YQqr3hDzVtm3eMauCtf0w_6TWMgTDIwHFwfhgsVKmxS0Nx45VXq5nLHWwzJFeGB/exec";
                    break;
                case "Despacho":
                    url = "https://script.google.com/macros/s/AKfycbyAJRH4AKz_6DxppZHsheeXY6oFlnZBxvI3PPcxHVB3Ukzu168pmGE3EIqjiD6AH8Is2w/exec";
                    break;
                case "Enfermería":
                    url = "https://script.google.com/macros/s/AKfycbxnuJ-It7xzGDJXNNxgbz0z_5JXofDhJ4x_Cpd8FyMW9GfQtIpfcamtja4cTGqVhh5b/exec";
                    break;
                case "Expedición":
                    url = "https://script.google.com/macros/s/AKfycbxE8oNzfJ4y_WKHw3rRfkVzQFjnLCukklYVALZnKijwL63DkAeaZ0e0rXzbj3fBjYen/exec";
                    break;
                case "Laboratorio de Calidad":
                    url = "https://script.google.com/macros/s/AKfycbw_a1J1x0wGcSxRhDjfeTm_BQNtj2x9zr_UyOQ5DMK7WvF389wAeD49XPiWOOCMOmwu/exec";
                    break;
                case "Laboratorio de Concreto":
                    url = "https://script.google.com/macros/s/AKfycbwrm7ZHnn3pTcZ7WZQ6JjMPr6e1TIAEIGQTwMzpWdAsL-7TXP-C4Xldzrc-smAPKtCoAw/exec";
                    break;
                case "Machaqueo A":
                    url = "https://script.google.com/macros/s/AKfycbzPMQ37DnhacGx9faq_iS5I9SM5aepWwF3ydRYSSvM8iOHvkoLV86B0yCvnZcx61Xgc/exec";
                    break;
                case "Posta Guardias":
                    url = "https://script.google.com/macros/s/AKfycbxvbPDMdk13YhXxbcHB6rCvfz4AFtzK6196ARmkMK2CdpDFoOwBacu0LF6lCAP5Fke2/exec";
                    break;
                case "Posta Recepción":
                    url = "https://script.google.com/macros/s/AKfycbzj89eoD6IrIkMEz0sNTMz6r3Y99FMs8KaS4xcPZRaXd2kGuFZ0Q3rxLd1hUIYUi1Fy/exec";
                    break;
                case "Sala de Control":
                    url = "https://script.google.com/macros/s/AKfycbyO4zsHjBr_wXxxFIcRQzirEjqOVJd1TRxlA6GRKtj5gYSscmuXOfdV3bI3DCBl_tDy9g/exec";
                    break;
                case "Salón Vial":
                    url = "https://script.google.com/macros/s/AKfycbyzpY7co1xqSaOjKumidJ_yilMRswDHxRe-uQkYCu1naOcaXCtrOZv9W65TbEmvWP2AiA/exec";
                    break;
                case "Taller Electrico":
                    url = "https://script.google.com/macros/s/AKfycbzWNTzYLbBuIQ50rb8OWMjXTQW51zUmfeoUW6CXgDpUWVaWf9V_9oPyaa7v5hn1wkUfTw/exec";
                    break;
                case "Transportistas":
                    url = "https://script.google.com/macros/s/AKfycbyPQd8EyeP8ir_jE8jwvgn6poYNfK7c1AI4Pstl4GtqVti9Gr1jvx-2L2HNZ6zwLZaL_w/exec";
                    break;
                default:
                    console.error("Baño no reconocido:", baño);
                    return;
            }
        } else {
            console.error("Tipo de actividad no reconocido:", tipo);
            return;
        }

        // Verificar que se haya asignado una URL válida
        if (!url) {
            console.error("No se pudo determinar la URL para enviar los datos.");
            return;
        }

        // Enviar los datos usando AJAX
        $.ajax({
            url: url,
            type: "POST",
            data: {
                fecha: fecha,
                tipo: tipo,
                area: area,
                baño: baño,
                oficina: oficina,
                actividades: JSON.stringify(actividades)
            },
            success: function(response) {
                console.log("Respuesta del servidor:", response);

                // Ocultar el overlay de espera
                document.getElementById('overlay').style.display = 'none';







                Swal.fire({
            text: "¡Envío exitoso! 🥳🎉",
            icon: "success",
            showCancelButton: false, // No mostrar el botón de cancelar
            confirmButtonText: "Aceptar",
            customClass: {
                content: "swal-content",
                confirmButton: "swal-button",
                popup: "swal-popup",
            },
                }).then(() => {
                    // Limpiar respuestas guardadas
                    limpiarRespuestasGuardadas();

                    // Recargar la página después de la confirmación
                    location.reload();
                });
            },
            error: function(xhr, status, error) {
                console.error("Error al enviar los datos:", xhr.responseText);

                // Ocultar el overlay de "Procesando..."
                document.getElementById("overlay").style.display = "none";

                Swal.fire({
                    text: 'Hubo un problema al enviar los datos. Intenta nuevamente. 😢',
                    icon: 'error',
                    confirmButtonText: 'Aceptar'
                });
            }
        });
    }

    // Función para guardar las respuestas en localStorage
    function guardarRespuestas() {
        const formData = {};

        // Recopilar todos los campos del formulario
        const inputs = document.querySelectorAll('input, select, textarea');
        inputs.forEach(input => {
            if (input.type !== 'file') { // Excluimos los campos de archivo
                formData[input.id] = input.value;
            }
        });

        // Guardar las actividades seleccionadas
        const actividades = [];
        document.querySelectorAll('input[name="actividad"]:checked').forEach(checkbox => {
            actividades.push(checkbox.value);
        });
        formData.actividades = actividades;

        // Guardar en localStorage
        localStorage.setItem('formData', JSON.stringify(formData));
    }

    // Función para cargar las respuestas guardadas
    function cargarRespuestas() {
        const savedData = localStorage.getItem('formData');
        if (savedData) {
            const formData = JSON.parse(savedData);

            // Cargar los valores de los campos
            Object.keys(formData).forEach(key => {
                const input = document.getElementById(key);
                if (input) {
                    input.value = formData[key];

                    // Disparar el evento "change" en los selects para que se muestren/oculten las preguntas dinámicas
                    if (input.tagName === 'SELECT') {
                        input.dispatchEvent(new Event('change'));
                    }
                }
            });

            // Cargar las actividades seleccionadas
            if (formData.actividades) {
                formData.actividades.forEach(actividad => {
                    const checkbox = document.querySelector(`input[name="actividad"][value="${actividad}"]`);
                    if (checkbox) {
                        checkbox.checked = true;
                    }
                });
            }

            // Actualizar el estado del botón de Enviar
            actualizarBotonEnviar();
        }
    }

    // Función para preguntar al usuario si desea continuar con las respuestas guardadas
    function preguntarContinuar() {
        const savedData = localStorage.getItem('formData');
        if (savedData) {
            Swal.fire({
                text: "Tienes un progreso guardado. ¿Te gustaría retomarlo?",
                iconHtml: "🫵🏻",
                showCancelButton: true,
                confirmButtonText: "Sí, continuar 😎",
                cancelButtonText: "No, reiniciar 🤓",
                allowOutsideClick: false, // Evita que el modal se cierre al hacer clic fuera
                customClass: {
                    popup: "swal-popup",
                    confirmButton: "swal-button",
                    cancelButton: "swal-button-cancel",
                    actions: "swal-actions",
                    icon: "no-border-icon", // Clase personalizada para el ícono
                },
            }).then((result) => {
                if (result.isConfirmed) {
                    cargarRespuestas(); // Continuar con el progreso guardado
                } else if (result.dismiss === Swal.DismissReason.cancel) {
                    // Mostrar segundo mensaje de confirmación
                    Swal.fire({
                        text: "¿Estás seguro de que deseas perder todo tu progreso?",
                        icon: "warning",
                        showCancelButton: true,
                        confirmButtonText: "Sí, reiniciar",
                        cancelButtonText: "No, recuperar progreso",
                        allowOutsideClick: false,
                        customClass: {
                            popup: "swal-popup",
                            confirmButton: "swal-button",
                            cancelButton: "swal-button-cancel",
                            actions: "swal-actions",
                        },
                    }).then((result) => {
                        if (result.isConfirmed) {
                            localStorage.removeItem('formData'); // Eliminar respuestas guardadas
                            location.reload(); // Recargar la página para reiniciar el formulario
                        } else {
                            cargarRespuestas(); // Recuperar el progreso guardado
                        }
                    });
                }
            });
        }
    }

    // Limpiar respuestas guardadas al enviar el formulario
    function limpiarRespuestasGuardadas() {
        localStorage.removeItem('formData');
    }

    // Escuchar cambios en los campos del formulario
    document.querySelectorAll('input, select, textarea').forEach(input => {
        input.addEventListener('input', guardarRespuestas);
        input.addEventListener('change', guardarRespuestas);
    });

    // Escuchar cambios en las actividades
    document.querySelector("#tablaActividades tbody").addEventListener("change", function (e) {
        if (e.target.type === "checkbox") {
            guardarRespuestas(); // Guardar respuestas al cambiar las actividades
            actualizarBotonEnviar(); // Actualizar el estado del botón
        }
    });

    // Llamar a la función al cargar la página
    window.onload = function() {
        preguntarContinuar();
        prellenarFechaHora(); // Precargar la fecha actual
    };

    let backPressCount = 0; // Contador para rastrear el número de veces que se presiona el botón atrás

    // Bloquear el historial al cargar la página
    history.pushState(null, null, document.URL);

    // Escuchar el evento "popstate" (cuando se presiona el botón atrás)
    window.addEventListener("popstate", function (event) {
        if (backPressCount === 0) {
            // Mostrar el mensaje de advertencia cuando se presiona el botón atrás por primera vez
            Swal.fire({
                text: "Si presionas el botón atrás nuevamente, saldrás del formulario.",
                icon: "warning",
                showCancelButton: false, // Eliminamos el botón de cancelar
                confirmButtonText: "Quedarme", // Cambiamos el texto del botón de confirmar
                allowOutsideClick: false, // Evita que el modal se cierre al hacer clic fuera
                customClass: {
                    popup: "swal-popup",
                    confirmButton: "swal-button",
                    actions: "swal-actions",
                    icon: "swal-icon-circle", // Clase personalizada para el ícono
                },
            }).then((result) => {
                if (result.isConfirmed) {
                    // Si el usuario hace clic en "Quedarme", reiniciamos el contador y bloqueamos el historial nuevamente
                    history.pushState(null, null, document.URL);
                    backPressCount = 0; // Reiniciamos el contador
                }
            });

            backPressCount++; // Aumentamos el contador para la siguiente vez
        } else {
            // Si el contador ya es mayor a 0, dejamos que el usuario salga del formulario
            backPressCount = 0; // Reiniciamos el contador
            history.back(); // Dejamos que el usuario salga
        }
    });
</script>

</body>
</html>
